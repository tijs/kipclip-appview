{
  "version": 3,
  "sources": ["frontend/index.tsx", "frontend/components/App.tsx", "frontend/components/Login.tsx", "frontend/components/BookmarkList.tsx", "frontend/components/AddBookmark.tsx", "frontend/components/EditBookmark.tsx", "frontend/context/AppContext.tsx", "frontend/utils/api.ts", "frontend/components/UserMenu.tsx", "frontend/components/TagSidebar.tsx", "frontend/components/AddTag.tsx", "frontend/components/EditTag.tsx", "shared/utils.ts", "frontend/components/Tools.tsx", "frontend/components/About.tsx", "frontend/components/Save.tsx", "frontend/components/FAQ.tsx", "frontend/components/SharedBookmarks.tsx"],
  "sourcesContent": ["import { createRoot } from \"react-dom/client\";\nimport { App } from \"./components/App.tsx\";\nimport { AppProvider } from \"./context/AppContext.tsx\";\n\n// Only run in browser environment\nif (typeof document !== \"undefined\") {\n  const root = createRoot(document.getElementById(\"root\")!);\n  root.render(\n    <AppProvider>\n      <App />\n    </AppProvider>,\n  );\n}\n", "import { useEffect, useState } from \"react\";\nimport { Login } from \"./Login.tsx\";\nimport { BookmarkList } from \"./BookmarkList.tsx\";\nimport { UserMenu } from \"./UserMenu.tsx\";\nimport { TagSidebar } from \"./TagSidebar.tsx\";\nimport { Tools } from \"./Tools.tsx\";\nimport { About } from \"./About.tsx\";\nimport { Save } from \"./Save.tsx\";\nimport { FAQ } from \"./FAQ.tsx\";\nimport { SharedBookmarks } from \"./SharedBookmarks.tsx\";\nimport { useApp } from \"../context/AppContext.tsx\";\n\nexport function App() {\n  const { session, setSession, loadInitialData } = useApp();\n  const [loading, setLoading] = useState(true);\n  const [dataLoading, setDataLoading] = useState(false);\n  const [currentPath, setCurrentPath] = useState(globalThis.location.pathname);\n\n  useEffect(() => {\n    checkSession();\n\n    // Listen for popstate events to update route\n    const handlePopState = () => {\n      setCurrentPath(globalThis.location.pathname);\n    };\n    globalThis.addEventListener(\"popstate\", handlePopState);\n    return () => globalThis.removeEventListener(\"popstate\", handlePopState);\n  }, []);\n\n  // Load initial data after session is confirmed\n  useEffect(() => {\n    if (session && !dataLoading) {\n      setDataLoading(true);\n      loadInitialData()\n        .catch((error) => {\n          console.error(\"Failed to load initial data:\", error);\n        })\n        .finally(() => {\n          setDataLoading(false);\n        });\n    }\n  }, [session]);\n\n  async function checkSession() {\n    try {\n      const response = await fetch(\"/api/auth/session\");\n      if (response.ok) {\n        const data = await response.json();\n        setSession({\n          did: data.did,\n          handle: data.handle,\n        });\n      }\n    } catch (error) {\n      console.error(\"Failed to check session:\", error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function handleLogout() {\n    try {\n      await fetch(\"/api/auth/logout\", { method: \"POST\" });\n      setSession(null);\n    } catch (error) {\n      console.error(\"Failed to logout:\", error);\n    }\n  }\n\n  // Handle special routes that don't require session check\n  if (currentPath === \"/tools\") {\n    return <Tools />;\n  }\n\n  if (currentPath === \"/about\") {\n    return <About />;\n  }\n\n  if (currentPath === \"/faq\") {\n    return <FAQ />;\n  }\n\n  if (currentPath === \"/save\") {\n    return <Save />;\n  }\n\n  // Handle shared bookmarks route: /share/:did/:encodedTags\n  if (currentPath.startsWith(\"/share/\")) {\n    const pathParts = currentPath.split(\"/\");\n    if (pathParts.length === 4) {\n      const did = pathParts[2];\n      const encodedTags = pathParts[3];\n      return <SharedBookmarks did={did} encodedTags={encodedTags} />;\n    }\n  }\n\n  if (loading || dataLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"spinner\"></div>\n      </div>\n    );\n  }\n\n  if (!session) {\n    return <Login />;\n  }\n\n  return (\n    <div className=\"min-h-screen md:h-screen flex flex-col\">\n      <header className=\"bg-white shadow-sm flex-shrink-0\">\n        <div className=\"px-4 py-4 flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <img\n              src=\"https://res.cloudinary.com/dru3aznlk/image/upload/v1760692589/kip-vignette_h2jwct.png\"\n              alt=\"Kip logo\"\n              className=\"w-8 h-8\"\n            />\n            <h1\n              className=\"text-2xl font-bold\"\n              style={{ color: \"var(--coral)\" }}\n            >\n              kipclip\n            </h1>\n          </div>\n          <UserMenu handle={session.handle} onLogout={handleLogout} />\n        </div>\n      </header>\n\n      <div className=\"flex flex-col md:flex-row flex-1 md:overflow-hidden\">\n        <TagSidebar />\n        <main className=\"flex-1 px-4 py-8 max-w-7xl mx-auto w-full md:overflow-y-auto\">\n          <BookmarkList />\n        </main>\n      </div>\n    </div>\n  );\n}\n", "import { useEffect, useRef, useState } from \"react\";\n\n/**\n * Validate an AT Protocol handle format.\n * Valid formats:\n * - user.bsky.social\n * - example.com\n * - subdomain.example.com\n */\nfunction validateHandle(handle: string): { valid: boolean; error?: string } {\n  const trimmed = handle.trim();\n\n  if (!trimmed) {\n    return { valid: false, error: \"Handle is required\" };\n  }\n\n  // Handle must contain at least one dot\n  if (!trimmed.includes(\".\")) {\n    return {\n      valid: false,\n      error: \"Handle must include a domain (e.g., alice.bsky.social)\",\n    };\n  }\n\n  // Basic format check: alphanumeric, dots, hyphens only\n  const validPattern = /^[a-zA-Z0-9][a-zA-Z0-9.-]*[a-zA-Z0-9]$/;\n  if (!validPattern.test(trimmed)) {\n    return {\n      valid: false,\n      error: \"Handle contains invalid characters\",\n    };\n  }\n\n  // Check for consecutive dots or dots at start/end (already handled by pattern above)\n  if (trimmed.includes(\"..\")) {\n    return {\n      valid: false,\n      error: \"Handle cannot contain consecutive dots\",\n    };\n  }\n\n  return { valid: true };\n}\n\nexport function Login() {\n  const [handle, setHandle] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  // Sync handle state when the Web Component updates the input value\n  useEffect(() => {\n    const input = inputRef.current;\n    if (!input) return;\n\n    // The actor-typeahead component sets input.value directly,\n    // so we need to listen for input events to sync React state\n    const handleInput = () => {\n      setHandle(input.value);\n    };\n\n    input.addEventListener(\"input\", handleInput);\n    return () => input.removeEventListener(\"input\", handleInput);\n  }, []);\n\n  function handleLogin(e: React.FormEvent) {\n    e.preventDefault();\n    setError(null);\n\n    // Read directly from input in case Web Component updated it without firing input event\n    const currentHandle = inputRef.current?.value || handle;\n\n    if (!currentHandle.trim()) return;\n\n    // Validate handle format\n    const validation = validateHandle(currentHandle);\n    if (!validation.valid) {\n      setError(validation.error || \"Invalid handle format\");\n      return;\n    }\n\n    setLoading(true);\n    try {\n      // Preserve redirect parameter if present\n      const params = new URLSearchParams(globalThis.location.search);\n      const redirect = params.get(\"redirect\");\n\n      let loginUrl = `/login?handle=${\n        encodeURIComponent(currentHandle.trim())\n      }`;\n      if (redirect) {\n        loginUrl += `&redirect=${encodeURIComponent(redirect)}`;\n      }\n\n      // Redirect to OAuth login\n      globalThis.location.href = loginUrl;\n    } catch (error) {\n      console.error(\"Login failed:\", error);\n      setError(\"Login failed. Please try again.\");\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center px-4\">\n      <div className=\"max-w-md w-full\">\n        <div className=\"text-center mb-8 fade-in\">\n          <img\n            src=\"https://res.cloudinary.com/dru3aznlk/image/upload/v1760376452/kip-satchel-transparent_ewnh0j.png\"\n            alt=\"kipclip mascot - a friendly chicken with a bookmark bag\"\n            className=\"w-48 h-48 mx-auto mb-6 object-contain\"\n          />\n          <h1\n            className=\"text-4xl font-bold mb-2\"\n            style={{ color: \"var(--coral)\" }}\n          >\n            kipclip\n          </h1>\n          <p className=\"text-gray-600\">\n            You find it, you kip it\n          </p>\n        </div>\n\n        <div className=\"card fade-in\">\n          <form onSubmit={handleLogin} className=\"space-y-4\">\n            <div>\n              <label\n                htmlFor=\"handle\"\n                className=\"block text-sm font-medium text-gray-700 mb-2\"\n              >\n                Your Bluesky or AT Protocol handle\n              </label>\n              {/* @ts-ignore - actor-typeahead is a custom element */}\n              <actor-typeahead>\n                <input\n                  ref={inputRef}\n                  type=\"text\"\n                  id=\"handle\"\n                  placeholder=\"alice.bsky.social or your-domain.com\"\n                  className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-coral focus:border-transparent outline-none transition\"\n                  disabled={loading}\n                  autoFocus\n                />\n                {/* @ts-ignore - actor-typeahead is a custom element */}\n              </actor-typeahead>\n            </div>\n\n            {error && (\n              <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\">\n                {error}\n              </div>\n            )}\n\n            <button\n              type=\"submit\"\n              disabled={loading || !handle.trim()}\n              className=\"btn-primary w-full disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {loading\n                ? (\n                  <span className=\"flex items-center justify-center gap-2\">\n                    <div className=\"spinner w-5 h-5 border-2\"></div>\n                    Connecting...\n                  </span>\n                )\n                : (\n                  \"Sign in\"\n                )}\n            </button>\n          </form>\n\n          <div className=\"mt-6 text-center text-sm text-gray-500 space-y-3\">\n            <p>\n              kipclip works with your Bluesky account or any AT Protocol handle.\n              Your bookmarks are saved to your own personal data server, so you\n              own and control your data.{\" \"}\n              <a\n                href=\"/faq\"\n                className=\"underline hover:text-gray-700\"\n              >\n                Learn more\n              </a>\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n", "import { useEffect, useRef, useState } from \"react\";\nimport { AddBookmark } from \"./AddBookmark.tsx\";\nimport { EditBookmark } from \"./EditBookmark.tsx\";\nimport { useApp } from \"../context/AppContext.tsx\";\n\nexport function BookmarkList() {\n  const {\n    filteredBookmarks: bookmarks,\n    tags: availableTags,\n    addBookmark,\n    updateBookmark,\n    deleteBookmark,\n    loadBookmarks: loadBookmarksFromContext,\n    loadTags,\n  } = useApp();\n\n  // Data is pre-loaded by App.tsx via loadInitialData(), so no initial loading state\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [editingBookmark, setEditingBookmark] = useState<any>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [dragOverBookmark, setDragOverBookmark] = useState<string | null>(null);\n\n  // Pull-to-refresh state\n  const [pullDistance, setPullDistance] = useState(0);\n  const [isPulling, setIsPulling] = useState(false);\n  const [isRefreshing, setIsRefreshing] = useState(false);\n  const touchStartY = useRef(0);\n\n  // Pull-to-refresh touch handlers\n  useEffect(() => {\n    function isAtTop(): boolean {\n      // Check both window scroll and main element scroll for PWA compatibility\n      const mainElement = document.querySelector(\"main\");\n      const windowAtTop = globalThis.scrollY === 0;\n      const mainAtTop = !mainElement || mainElement.scrollTop === 0;\n      return windowAtTop && mainAtTop;\n    }\n\n    function handleTouchStart(e: TouchEvent) {\n      // Only start pull if scrolled to top\n      if (isAtTop()) {\n        touchStartY.current = e.touches[0].clientY;\n        setIsPulling(true);\n      }\n    }\n\n    function handleTouchMove(e: TouchEvent) {\n      if (!isPulling || isRefreshing) return;\n\n      const touchY = e.touches[0].clientY;\n      const distance = touchY - touchStartY.current;\n\n      // Only pull down, and limit distance\n      if (distance > 0 && isAtTop()) {\n        e.preventDefault();\n        setPullDistance(Math.min(distance, 120));\n      }\n    }\n\n    function handleTouchEnd() {\n      if (!isPulling) return;\n\n      setIsPulling(false);\n\n      // Trigger refresh if pulled far enough\n      if (pullDistance > 80) {\n        setIsRefreshing(true);\n        loadBookmarks().finally(() => {\n          setIsRefreshing(false);\n          setPullDistance(0);\n        });\n      } else {\n        setPullDistance(0);\n      }\n    }\n\n    // Listen on document level to catch all touch events\n    document.addEventListener(\"touchstart\", handleTouchStart, {\n      passive: true,\n    });\n    document.addEventListener(\"touchmove\", handleTouchMove, {\n      passive: false,\n    });\n    document.addEventListener(\"touchend\", handleTouchEnd);\n\n    return () => {\n      document.removeEventListener(\"touchstart\", handleTouchStart);\n      document.removeEventListener(\"touchmove\", handleTouchMove);\n      document.removeEventListener(\"touchend\", handleTouchEnd);\n    };\n  }, [isPulling, pullDistance, isRefreshing]);\n\n  // Manual refresh (for pull-to-refresh and retry button)\n  async function loadBookmarks() {\n    setError(null);\n    try {\n      await loadBookmarksFromContext();\n    } catch (err: any) {\n      setError(err.message);\n    }\n  }\n\n  function handleBookmarkUpdated(bookmark: any) {\n    updateBookmark(bookmark);\n    setEditingBookmark(null);\n  }\n\n  function handleBookmarkDeleted(uri: string) {\n    deleteBookmark(uri);\n    setEditingBookmark(null);\n  }\n\n  function handleBookmarkAdded(bookmark: any) {\n    addBookmark(bookmark);\n    setShowAddModal(false);\n  }\n\n  async function handleDropTag(bookmarkUri: string, tagValue: string) {\n    try {\n      // Extract rkey from URI\n      const rkey = bookmarkUri.split(\"/\").pop();\n      if (!rkey) {\n        throw new Error(\"Invalid bookmark URI\");\n      }\n\n      // Find the bookmark\n      const bookmark = bookmarks.find((b) => b.uri === bookmarkUri);\n      if (!bookmark) {\n        throw new Error(\"Bookmark not found\");\n      }\n\n      // Check if tag already exists\n      if (bookmark.tags?.includes(tagValue)) {\n        return; // Skip if already tagged\n      }\n\n      // Add tag to existing tags\n      const newTags = [...(bookmark.tags || []), tagValue];\n\n      // Update via API\n      const response = await fetch(`/api/bookmarks/${rkey}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ tags: newTags }),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to update bookmark tags\");\n      }\n\n      const data = await response.json();\n\n      // Update context state\n      updateBookmark(data.bookmark);\n    } catch (err: any) {\n      console.error(\"Failed to add tag to bookmark:\", err);\n      alert(`Failed to add tag: ${err.message}`);\n    }\n  }\n\n  function handleVisit(e: React.MouseEvent, url: string) {\n    e.stopPropagation();\n    globalThis.open(url, \"_blank\", \"noopener,noreferrer\");\n  }\n\n  async function handleShare(e: React.MouseEvent, bookmark: any) {\n    e.stopPropagation();\n\n    const shareData = {\n      title: bookmark.title || new URL(bookmark.subject).hostname,\n      text: bookmark.description\n        ? `${\n          bookmark.title || new URL(bookmark.subject).hostname\n        }\\n\\n${bookmark.description}`\n        : bookmark.title || new URL(bookmark.subject).hostname,\n      url: bookmark.subject,\n    };\n\n    // Check if Web Share API is supported\n    if (navigator.share) {\n      try {\n        await navigator.share(shareData);\n      } catch (err: any) {\n        // User cancelled or share failed\n        if (err.name !== \"AbortError\") {\n          console.error(\"Share failed:\", err);\n        }\n      }\n    } else {\n      // Fallback: copy to clipboard\n      try {\n        const textToCopy =\n          `${shareData.title}\\n${shareData.text}\\n${shareData.url}`;\n        await navigator.clipboard.writeText(textToCopy);\n        alert(\"Link copied to clipboard!\");\n      } catch (err) {\n        console.error(\"Failed to copy:\", err);\n        alert(\"Sharing not supported on this browser\");\n      }\n    }\n  }\n\n  if (error) {\n    return (\n      <div className=\"text-center py-20\">\n        <p className=\"text-red-600 mb-4\">Error: {error}</p>\n        <button type=\"button\" onClick={loadBookmarks} className=\"btn-primary\">\n          Try Again\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"fade-in\">\n      {/* Pull-to-refresh indicator */}\n      <div\n        style={{\n          position: \"fixed\",\n          top: 0,\n          left: 0,\n          right: 0,\n          height: `${pullDistance}px`,\n          display: pullDistance > 0 ? \"flex\" : \"none\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          backgroundColor: \"var(--coral)\",\n          color: \"white\",\n          zIndex: 40,\n          transition: isPulling ? \"none\" : \"height 0.3s ease-out\",\n        }}\n      >\n        {isRefreshing\n          ? (\n            <div\n              className=\"spinner\"\n              style={{\n                borderColor: \"white transparent transparent transparent\",\n              }}\n            >\n            </div>\n          )\n          : (\n            <span style={{ fontSize: \"24px\" }}>\n              {pullDistance > 80 ? \"\u2193\" : \"\u2191\"}\n            </span>\n          )}\n      </div>\n\n      <div className=\"mb-6\">\n        {/* Desktop: side-by-side layout */}\n        <div className=\"hidden md:flex items-center justify-between\">\n          <h2 className=\"text-2xl font-bold text-gray-800\">\n            Your Bookmarks\n            <span className=\"text-sm font-normal text-gray-500 ml-3\">\n              {bookmarks.length}{\" \"}\n              {bookmarks.length === 1 ? \"bookmark\" : \"bookmarks\"}\n            </span>\n          </h2>\n          <button\n            type=\"button\"\n            onClick={() => setShowAddModal(true)}\n            className=\"btn-primary\"\n          >\n            + Add Bookmark\n          </button>\n        </div>\n\n        {/* Mobile: stacked layout */}\n        <div className=\"md:hidden\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <h2 className=\"text-2xl font-bold text-gray-800\">\n              Your Bookmarks\n            </h2>\n            <button\n              type=\"button\"\n              onClick={() => setShowAddModal(true)}\n              className=\"px-3 py-2 text-sm rounded-md\"\n              style={{ backgroundColor: \"var(--coral)\", color: \"white\" }}\n            >\n              + Add\n            </button>\n          </div>\n          <p className=\"text-sm text-gray-500\">\n            {bookmarks.length}{\" \"}\n            {bookmarks.length === 1 ? \"bookmark\" : \"bookmarks\"}\n          </p>\n        </div>\n      </div>\n\n      {bookmarks.length === 0\n        ? (\n          <div className=\"text-center py-20\">\n            <div className=\"mb-6\">\n              <span className=\"text-6xl\">\uD83D\uDCDA</span>\n            </div>\n            <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">\n              No bookmarks yet\n            </h3>\n            <p className=\"text-gray-500 mb-6\">\n              Start collecting your favorite links!\n            </p>\n            <button\n              type=\"button\"\n              onClick={() => setShowAddModal(true)}\n              className=\"btn-primary\"\n            >\n              Add Your First Bookmark\n            </button>\n          </div>\n        )\n        : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {bookmarks.map((bookmark) => (\n              <div\n                key={bookmark.uri}\n                className={`card hover:scale-[1.02] transition-all cursor-pointer group relative ${\n                  dragOverBookmark === bookmark.uri\n                    ? \"border-2 border-blue-500 bg-blue-50\"\n                    : \"\"\n                }`}\n                onClick={() => setEditingBookmark(bookmark)}\n                onDragOver={(e) => {\n                  e.preventDefault();\n                  e.dataTransfer.dropEffect = \"copy\";\n                }}\n                onDragEnter={(e) => {\n                  e.preventDefault();\n                  setDragOverBookmark(bookmark.uri);\n                }}\n                onDragLeave={(e) => {\n                  e.preventDefault();\n                  // Only clear if we're leaving the card itself, not a child\n                  if (e.currentTarget === e.target) {\n                    setDragOverBookmark(null);\n                  }\n                }}\n                onDrop={(e) => {\n                  e.preventDefault();\n                  setDragOverBookmark(null);\n                  const tagValue = e.dataTransfer.getData(\"text/plain\");\n                  if (tagValue) {\n                    handleDropTag(bookmark.uri, tagValue);\n                  }\n                }}\n              >\n                <div className=\"mb-3\">\n                  <h3 className=\"font-semibold text-gray-800 truncate mb-1\">\n                    {bookmark.title || new URL(bookmark.subject).hostname}\n                  </h3>\n                  <div className=\"text-sm text-gray-500 truncate\">\n                    {bookmark.subject}\n                  </div>\n                </div>\n\n                <div className=\"text-xs text-gray-400\">\n                  {new Date(bookmark.createdAt).toLocaleDateString()}\n                </div>\n\n                {bookmark.tags && bookmark.tags.length > 0 && (\n                  <div className=\"flex flex-wrap gap-1 mt-2\">\n                    {bookmark.tags.map((tag, i) => (\n                      <span\n                        key={i}\n                        className=\"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-700\"\n                      >\n                        {tag}\n                      </span>\n                    ))}\n                  </div>\n                )}\n\n                {/* Desktop: hover-reveal buttons (bottom-right) */}\n                <div className=\"hidden md:group-hover:flex absolute bottom-2 right-2 gap-1\">\n                  <button\n                    type=\"button\"\n                    onClick={(e) => handleVisit(e, bookmark.subject)}\n                    className=\"w-7 h-7 flex items-center justify-center text-gray-600 hover:text-gray-900 bg-white/90 hover:bg-white rounded-md transition-colors shadow-sm\"\n                    title=\"Visit bookmark\"\n                  >\n                    <svg\n                      className=\"w-4 h-4\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <path\n                        strokeLinecap=\"round\"\n                        strokeLinejoin=\"round\"\n                        strokeWidth={2}\n                        d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\"\n                      />\n                    </svg>\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={(e) => handleShare(e, bookmark)}\n                    className=\"w-7 h-7 flex items-center justify-center text-gray-600 hover:text-gray-900 bg-white/90 hover:bg-white rounded-md transition-colors shadow-sm\"\n                    title=\"Share bookmark\"\n                  >\n                    <svg\n                      className=\"w-4 h-4\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <path\n                        strokeLinecap=\"round\"\n                        strokeLinejoin=\"round\"\n                        strokeWidth={2}\n                        d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z\"\n                      />\n                    </svg>\n                  </button>\n                </div>\n\n                {/* Mobile: always-visible buttons (bottom-right) */}\n                <div className=\"flex md:hidden absolute bottom-2 right-2 gap-1\">\n                  <button\n                    type=\"button\"\n                    onClick={(e) => handleVisit(e, bookmark.subject)}\n                    className=\"w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 bg-white/90 hover:bg-white rounded-md transition-colors shadow-sm\"\n                    title=\"Visit bookmark\"\n                  >\n                    <svg\n                      className=\"w-4 h-4\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <path\n                        strokeLinecap=\"round\"\n                        strokeLinejoin=\"round\"\n                        strokeWidth={2}\n                        d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\"\n                      />\n                    </svg>\n                  </button>\n                  <button\n                    type=\"button\"\n                    onClick={(e) => handleShare(e, bookmark)}\n                    className=\"w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 bg-white/90 hover:bg-white rounded-md transition-colors shadow-sm\"\n                    title=\"Share bookmark\"\n                  >\n                    <svg\n                      className=\"w-4 h-4\"\n                      fill=\"none\"\n                      stroke=\"currentColor\"\n                      viewBox=\"0 0 24 24\"\n                    >\n                      <path\n                        strokeLinecap=\"round\"\n                        strokeLinejoin=\"round\"\n                        strokeWidth={2}\n                        d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z\"\n                      />\n                    </svg>\n                  </button>\n                </div>\n              </div>\n            ))}\n          </div>\n        )}\n\n      {showAddModal && (\n        <AddBookmark\n          onClose={() => setShowAddModal(false)}\n          onBookmarkAdded={handleBookmarkAdded}\n        />\n      )}\n\n      {editingBookmark && (\n        <EditBookmark\n          bookmark={editingBookmark}\n          availableTags={availableTags}\n          onClose={() => setEditingBookmark(null)}\n          onBookmarkUpdated={handleBookmarkUpdated}\n          onBookmarkDeleted={handleBookmarkDeleted}\n          onTagsChanged={loadTags}\n        />\n      )}\n    </div>\n  );\n}\n", "import { useState } from \"react\";\nimport type { EnrichedBookmark } from \"../../shared/types.ts\";\n\ninterface AddBookmarkProps {\n  onClose: () => void;\n  onBookmarkAdded: (bookmark: EnrichedBookmark) => void;\n}\n\nexport function AddBookmark({ onClose, onBookmarkAdded }: AddBookmarkProps) {\n  const [url, setUrl] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    if (!url.trim()) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(\"/api/bookmarks\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ url: url.trim() }),\n      });\n\n      if (!response.ok) {\n        const data = await response.json();\n        throw new Error(data.error || \"Failed to add bookmark\");\n      }\n\n      const data = await response.json();\n      onBookmarkAdded(data.bookmark);\n    } catch (err: any) {\n      setError(err.message);\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-md w-full p-6 fade-in\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-xl font-bold text-gray-800\">Add Bookmark</h3>\n          <button\n            type=\"button\"\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 text-2xl\"\n            disabled={loading}\n          >\n            \u00D7\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <label\n              htmlFor=\"url\"\n              className=\"block text-sm font-medium text-gray-700 mb-2\"\n            >\n              URL\n            </label>\n            <input\n              type=\"url\"\n              id=\"url\"\n              value={url}\n              onChange={(e) => setUrl(e.target.value)}\n              placeholder=\"https://example.com\"\n              className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-coral focus:border-transparent outline-none transition\"\n              disabled={loading}\n              autoFocus\n              required\n            />\n          </div>\n\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"flex gap-3\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"flex-1 px-4 py-3 rounded-lg border border-gray-300 text-gray-700 font-medium hover:bg-gray-50 transition\"\n              disabled={loading}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              className=\"flex-1 btn-primary disabled:opacity-50\"\n              disabled={loading || !url.trim()}\n            >\n              {loading\n                ? (\n                  <span className=\"flex items-center justify-center gap-2\">\n                    <div className=\"spinner w-5 h-5 border-2\"></div>\n                    Adding...\n                  </span>\n                )\n                : (\n                  \"Add Bookmark\"\n                )}\n            </button>\n          </div>\n        </form>\n\n        <p className=\"text-xs text-gray-500 mt-4 text-center\">\n          The page title will be automatically fetched and saved with your\n          bookmark\n        </p>\n      </div>\n    </div>\n  );\n}\n", "import { useState } from \"react\";\nimport type { EnrichedBookmark, EnrichedTag } from \"../../shared/types.ts\";\n\ninterface EditBookmarkProps {\n  bookmark: EnrichedBookmark;\n  availableTags: EnrichedTag[];\n  onClose: () => void;\n  onBookmarkUpdated: (bookmark: EnrichedBookmark) => void;\n  onBookmarkDeleted: (uri: string) => void;\n  onTagsChanged?: () => void;\n}\n\nexport function EditBookmark({\n  bookmark,\n  availableTags,\n  onClose,\n  onBookmarkUpdated,\n  onBookmarkDeleted,\n  onTagsChanged,\n}: EditBookmarkProps) {\n  const [tags, setTags] = useState<string[]>(bookmark.tags || []);\n  const [tagInput, setTagInput] = useState(\"\");\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Editable fields state\n  const [title, setTitle] = useState(bookmark.title || \"\");\n  const [url, setUrl] = useState(bookmark.subject);\n  const [description, setDescription] = useState(bookmark.description || \"\");\n\n  // Filter suggestions based on input\n  const suggestions = availableTags\n    .filter((tag) =>\n      tag.value.toLowerCase().includes(tagInput.toLowerCase()) &&\n      !tags.includes(tag.value)\n    )\n    .slice(0, 5);\n\n  function handleAddTag(tagValue: string) {\n    if (tagValue && !tags.includes(tagValue)) {\n      setTags([...tags, tagValue]);\n      setTagInput(\"\");\n      setShowSuggestions(false);\n    }\n  }\n\n  function handleRemoveTag(tagValue: string) {\n    setTags(tags.filter((t) => t !== tagValue));\n  }\n\n  function handleTagInputKeyDown(e: React.KeyboardEvent<HTMLInputElement>) {\n    if (e.key === \"Enter\") {\n      e.preventDefault();\n      if (suggestions.length > 0) {\n        handleAddTag(suggestions[0].value);\n      } else if (tagInput.trim()) {\n        handleAddTag(tagInput.trim());\n      }\n    } else if (e.key === \"Escape\") {\n      setShowSuggestions(false);\n    }\n  }\n\n  async function handleSave() {\n    setLoading(true);\n    setError(null);\n\n    try {\n      // Find new tags that don't exist in availableTags\n      const existingTagValues = new Set(availableTags.map((t) => t.value));\n      const newTags = tags.filter((tag) => !existingTagValues.has(tag));\n\n      // Create tag records for new tags\n      for (const tagValue of newTags) {\n        try {\n          await fetch(\"/api/tags\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n            body: JSON.stringify({ value: tagValue }),\n          });\n        } catch (err) {\n          console.error(`Failed to create tag record for \"${tagValue}\":`, err);\n          // Continue even if tag creation fails\n        }\n      }\n\n      // Update bookmark with all editable fields\n      const rkey = bookmark.uri.split(\"/\").pop();\n      const response = await fetch(`/api/bookmarks/${rkey}`, {\n        method: \"PATCH\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          tags,\n          title,\n          url,\n          description,\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to update bookmark\");\n      }\n\n      const data = await response.json();\n\n      // Refresh tag list if new tags were created\n      if (newTags.length > 0 && onTagsChanged) {\n        onTagsChanged();\n      }\n\n      onBookmarkUpdated(data.bookmark);\n    } catch (err: any) {\n      setError(err.message);\n      setLoading(false);\n    }\n  }\n\n  async function handleDelete() {\n    if (!confirm(\"Are you sure you want to delete this bookmark?\")) {\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const rkey = bookmark.uri.split(\"/\").pop();\n      const response = await fetch(`/api/bookmarks/${rkey}`, {\n        method: \"DELETE\",\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to delete bookmark\");\n      }\n\n      onBookmarkDeleted(bookmark.uri);\n    } catch (err: any) {\n      setError(err.message);\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto fade-in\">\n        <div className=\"sticky top-0 bg-white border-b border-gray-200 px-6 py-4\">\n          <div className=\"flex items-center justify-between\">\n            <h3 className=\"text-xl font-bold text-gray-800\">Edit Bookmark</h3>\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"text-gray-400 hover:text-gray-600 text-2xl\"\n              disabled={loading}\n            >\n              \u00D7\n            </button>\n          </div>\n        </div>\n\n        <div className=\"px-6 py-4 space-y-4\">\n          {/* Title - Editable */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Title\n            </label>\n            <input\n              type=\"text\"\n              value={title}\n              onChange={(e) => setTitle(e.target.value)}\n              placeholder=\"Enter bookmark title\"\n              className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-coral focus:border-transparent outline-none transition\"\n              disabled={loading}\n            />\n          </div>\n\n          {/* URL - Editable */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              URL\n            </label>\n            <input\n              type=\"url\"\n              value={url}\n              onChange={(e) => setUrl(e.target.value)}\n              placeholder=\"https://example.com\"\n              className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-coral focus:border-transparent outline-none transition\"\n              disabled={loading}\n            />\n          </div>\n\n          {/* Description - Editable */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Description\n            </label>\n            <textarea\n              value={description}\n              onChange={(e) => setDescription(e.target.value)}\n              placeholder=\"Enter bookmark description (optional)\"\n              rows={3}\n              className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-coral focus:border-transparent outline-none transition resize-y\"\n              disabled={loading}\n            />\n          </div>\n\n          {/* Tags - Editable */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Tags\n            </label>\n\n            {/* Current tags */}\n            {tags.length > 0 && (\n              <div className=\"flex flex-wrap gap-2 mb-3\">\n                {tags.map((tag) => (\n                  <span\n                    key={tag}\n                    className=\"inline-flex items-center gap-1 px-3 py-1 rounded-full bg-gray-100 text-gray-700 text-sm\"\n                  >\n                    {tag}\n                    <button\n                      type=\"button\"\n                      onClick={() => handleRemoveTag(tag)}\n                      className=\"text-gray-500 hover:text-red-600 ml-1\"\n                      disabled={loading}\n                    >\n                      \u00D7\n                    </button>\n                  </span>\n                ))}\n              </div>\n            )}\n\n            {/* Add tag input */}\n            <div className=\"relative\">\n              <input\n                type=\"text\"\n                value={tagInput}\n                onChange={(e) => {\n                  setTagInput(e.target.value);\n                  setShowSuggestions(true);\n                }}\n                onKeyDown={handleTagInputKeyDown}\n                onFocus={() => setShowSuggestions(true)}\n                onBlur={() => setTimeout(() => setShowSuggestions(false), 200)}\n                placeholder=\"Add tags...\"\n                className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-coral focus:border-transparent outline-none transition\"\n                disabled={loading}\n              />\n\n              {/* Suggestions dropdown */}\n              {showSuggestions && suggestions.length > 0 && (\n                <div className=\"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-48 overflow-y-auto\">\n                  {suggestions.map((tag) => (\n                    <button\n                      key={tag.uri}\n                      type=\"button\"\n                      onClick={() => handleAddTag(tag.value)}\n                      className=\"w-full text-left px-4 py-2 hover:bg-gray-50 text-gray-700 text-sm\"\n                    >\n                      {tag.value}\n                    </button>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            <p className=\"text-xs text-gray-500 mt-2\">\n              Type to search existing tags or press Enter to create a new one\n            </p>\n          </div>\n\n          {/* Created date */}\n          <div className=\"text-xs text-gray-400 pt-2\">\n            Created {new Date(bookmark.createdAt).toLocaleDateString()} at{\" \"}\n            {new Date(bookmark.createdAt).toLocaleTimeString()}\n          </div>\n\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\">\n              {error}\n            </div>\n          )}\n        </div>\n\n        {/* Footer with action buttons */}\n        <div className=\"sticky bottom-0 bg-white border-t border-gray-200 px-6 py-4 space-y-3\">\n          <div className=\"flex gap-3\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"flex-1 px-4 py-3 rounded-lg border border-gray-300 text-gray-700 font-medium hover:bg-gray-50 transition\"\n              disabled={loading}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleSave}\n              className=\"flex-1 btn-primary disabled:opacity-50\"\n              disabled={loading}\n            >\n              {loading\n                ? (\n                  <span className=\"flex items-center justify-center gap-2\">\n                    <div className=\"spinner w-5 h-5 border-2\"></div>\n                    Saving...\n                  </span>\n                )\n                : (\n                  \"Save Changes\"\n                )}\n            </button>\n          </div>\n\n          <button\n            type=\"button\"\n            onClick={handleDelete}\n            className=\"w-full px-4 py-3 rounded-lg bg-red-50 text-red-600 font-medium hover:bg-red-100 transition border border-red-200\"\n            disabled={loading}\n          >\n            Delete Bookmark\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n", "import { createContext, type ReactNode, useContext, useState } from \"react\";\nimport type {\n  EnrichedBookmark,\n  EnrichedTag,\n  InitialDataResponse,\n  SessionInfo,\n} from \"../../shared/types.ts\";\nimport { apiGet } from \"../utils/api.ts\";\n\ninterface AppState {\n  session: SessionInfo | null;\n  bookmarks: EnrichedBookmark[];\n  tags: EnrichedTag[];\n  selectedTags: Set<string>;\n  loading: boolean;\n}\n\ninterface AppContextValue extends AppState {\n  // Session actions\n  setSession: (session: SessionInfo | null) => void;\n\n  // Bookmark actions\n  setBookmarks: (bookmarks: EnrichedBookmark[]) => void;\n  addBookmark: (bookmark: EnrichedBookmark) => void;\n  updateBookmark: (bookmark: EnrichedBookmark) => void;\n  deleteBookmark: (uri: string) => void;\n  loadBookmarks: () => Promise<void>;\n\n  // Tag actions\n  setTags: (tags: EnrichedTag[]) => void;\n  addTag: (tag: EnrichedTag) => void;\n  updateTag: (tag: EnrichedTag) => void;\n  deleteTag: (uri: string) => void;\n  loadTags: () => Promise<void>;\n\n  // Combined initial data loading (avoids token refresh race condition)\n  loadInitialData: () => Promise<void>;\n\n  // Filter actions\n  toggleTag: (tagValue: string) => void;\n  clearFilters: () => void;\n\n  // Computed values\n  filteredBookmarks: EnrichedBookmark[];\n}\n\nconst AppContext = createContext<AppContextValue | null>(null);\n\nexport function AppProvider({ children }: { children: ReactNode }) {\n  const [session, setSession] = useState<SessionInfo | null>(null);\n  const [bookmarks, setBookmarks] = useState<EnrichedBookmark[]>([]);\n  const [tags, setTags] = useState<EnrichedTag[]>([]);\n  const [selectedTags, setSelectedTags] = useState<Set<string>>(new Set());\n  const [loading, _setLoading] = useState(true);\n\n  // Bookmark actions\n  async function loadBookmarks() {\n    try {\n      const response = await apiGet(\"/api/bookmarks\");\n      if (!response.ok) {\n        throw new Error(\"Failed to load bookmarks\");\n      }\n      const data = await response.json();\n      setBookmarks(data.bookmarks);\n    } catch (err) {\n      console.error(\"Failed to load bookmarks:\", err);\n      throw err;\n    }\n  }\n\n  function addBookmark(bookmark: EnrichedBookmark) {\n    setBookmarks((prev) => [bookmark, ...prev]);\n  }\n\n  function updateBookmark(bookmark: EnrichedBookmark) {\n    setBookmarks((prev) =>\n      prev.map((b) => b.uri === bookmark.uri ? bookmark : b)\n    );\n  }\n\n  function deleteBookmark(uri: string) {\n    setBookmarks((prev) => prev.filter((b) => b.uri !== uri));\n  }\n\n  // Tag actions\n  async function loadTags() {\n    try {\n      const response = await apiGet(\"/api/tags\");\n      if (!response.ok) {\n        throw new Error(\"Failed to load tags\");\n      }\n      const data = await response.json();\n      setTags(data.tags);\n    } catch (err) {\n      console.error(\"Failed to load tags:\", err);\n      throw err;\n    }\n  }\n\n  function addTag(tag: EnrichedTag) {\n    setTags((prev) => [tag, ...prev]);\n  }\n\n  function updateTag(tag: EnrichedTag) {\n    setTags((prev) => prev.map((t) => t.uri === tag.uri ? tag : t));\n  }\n\n  function deleteTag(uri: string) {\n    setTags((prev) => prev.filter((t) => t.uri !== uri));\n  }\n\n  // Combined initial data loading (avoids token refresh race condition)\n  async function loadInitialData() {\n    try {\n      const response = await apiGet(\"/api/initial-data\");\n      if (!response.ok) {\n        throw new Error(\"Failed to load initial data\");\n      }\n      const data: InitialDataResponse = await response.json();\n      setBookmarks(data.bookmarks);\n      setTags(data.tags);\n    } catch (err) {\n      console.error(\"Failed to load initial data:\", err);\n      throw err;\n    }\n  }\n\n  // Filter actions\n  function toggleTag(tagValue: string) {\n    setSelectedTags((prev) => {\n      const newSet = new Set(prev);\n      if (newSet.has(tagValue)) {\n        newSet.delete(tagValue);\n      } else {\n        newSet.add(tagValue);\n      }\n      return newSet;\n    });\n  }\n\n  function clearFilters() {\n    setSelectedTags(new Set());\n  }\n\n  // Computed values\n  const filteredBookmarks = selectedTags.size === 0\n    ? bookmarks\n    : bookmarks.filter((bookmark) =>\n      [...selectedTags].every((tag) => bookmark.tags?.includes(tag))\n    );\n\n  const value: AppContextValue = {\n    // State\n    session,\n    bookmarks,\n    tags,\n    selectedTags,\n    loading,\n\n    // Session actions\n    setSession,\n\n    // Bookmark actions\n    setBookmarks,\n    addBookmark,\n    updateBookmark,\n    deleteBookmark,\n    loadBookmarks,\n\n    // Tag actions\n    setTags,\n    addTag,\n    updateTag,\n    deleteTag,\n    loadTags,\n\n    // Combined initial data loading\n    loadInitialData,\n\n    // Filter actions\n    toggleTag,\n    clearFilters,\n\n    // Computed values\n    filteredBookmarks,\n  };\n\n  return <AppContext.Provider value={value}>{children}</AppContext.Provider>;\n}\n\nexport function useApp() {\n  const context = useContext(AppContext);\n  if (!context) {\n    throw new Error(\"useApp must be used within AppProvider\");\n  }\n  return context;\n}\n", "/**\n * Centralized API client with automatic 401 handling\n * When a 401 response is received, the session is cleared and the user is redirected to login\n */\n\n/**\n * Enhanced fetch that handles 401 responses automatically\n * Clears local session state and reloads the page to trigger login flow\n */\nexport async function apiFetch(\n  url: string,\n  options?: RequestInit,\n): Promise<Response> {\n  const response = await fetch(url, options);\n\n  // If we get a 401, the session has expired\n  if (response.status === 401) {\n    console.warn(\"Session expired, redirecting to login\");\n\n    // Clear any local session state\n    try {\n      // Trigger a page reload which will check session and show login\n      globalThis.location.href = \"/\";\n    } catch (error) {\n      console.error(\"Failed to redirect after session expiry:\", error);\n    }\n\n    // Return the response anyway for consistency\n    return response;\n  }\n\n  return response;\n}\n\n/**\n * Helper for GET requests\n */\nexport function apiGet(url: string): Promise<Response> {\n  return apiFetch(url);\n}\n\n/**\n * Helper for POST requests\n */\nexport function apiPost(\n  url: string,\n  body?: any,\n): Promise<Response> {\n  return apiFetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: body ? JSON.stringify(body) : undefined,\n  });\n}\n\n/**\n * Helper for PATCH requests\n */\nexport function apiPatch(\n  url: string,\n  body?: any,\n): Promise<Response> {\n  return apiFetch(url, {\n    method: \"PATCH\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: body ? JSON.stringify(body) : undefined,\n  });\n}\n\n/**\n * Helper for PUT requests\n */\nexport function apiPut(\n  url: string,\n  body?: any,\n): Promise<Response> {\n  return apiFetch(url, {\n    method: \"PUT\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: body ? JSON.stringify(body) : undefined,\n  });\n}\n\n/**\n * Helper for DELETE requests\n */\nexport function apiDelete(url: string): Promise<Response> {\n  return apiFetch(url, {\n    method: \"DELETE\",\n  });\n}\n", "import { useEffect, useRef, useState } from \"react\";\n\ninterface UserMenuProps {\n  handle: string;\n  onLogout: () => void;\n}\n\nexport function UserMenu({ handle, onLogout }: UserMenuProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    function handleClickOutside(event: MouseEvent) {\n      if (menuRef.current && !menuRef.current.contains(event.target as Node)) {\n        setIsOpen(false);\n      }\n    }\n\n    if (isOpen) {\n      document.addEventListener(\"mousedown\", handleClickOutside);\n    }\n\n    return () => {\n      document.removeEventListener(\"mousedown\", handleClickOutside);\n    };\n  }, [isOpen]);\n\n  return (\n    <div className=\"relative\" ref={menuRef}>\n      {/* Desktop: Username button */}\n      <button\n        type=\"button\"\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"hidden md:flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100 transition-colors\"\n        aria-expanded={isOpen}\n        aria-haspopup=\"true\"\n      >\n        <span className=\"text-sm font-medium text-gray-700\">\n          @{handle}\n        </span>\n        <svg\n          className={`w-4 h-4 text-gray-500 transition-transform ${\n            isOpen ? \"rotate-180\" : \"\"\n          }`}\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M19 9l-7 7-7-7\"\n          />\n        </svg>\n      </button>\n\n      {/* Mobile: Hamburger button */}\n      <button\n        type=\"button\"\n        onClick={() => setIsOpen(!isOpen)}\n        className=\"md:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors\"\n        aria-expanded={isOpen}\n        aria-haspopup=\"true\"\n        aria-label=\"Menu\"\n      >\n        <svg\n          className=\"w-6 h-6 text-gray-700\"\n          fill=\"none\"\n          stroke=\"currentColor\"\n          viewBox=\"0 0 24 24\"\n        >\n          {isOpen\n            ? (\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M6 18L18 6M6 6l12 12\"\n              />\n            )\n            : (\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M4 6h16M4 12h16M4 18h16\"\n              />\n            )}\n        </svg>\n      </button>\n\n      {/* Dropdown menu */}\n      {isOpen && (\n        <div className=\"absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50\">\n          {/* Mobile only: Show username in menu */}\n          <div className=\"md:hidden px-4 py-3 border-b border-gray-200\">\n            <p className=\"text-sm font-medium text-gray-900\">@{handle}</p>\n          </div>\n\n          <a\n            href=\"/tools\"\n            className=\"flex items-center gap-2 w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\n            onClick={() => setIsOpen(false)}\n          >\n            <svg\n              className=\"w-4 h-4\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M13 10V3L4 14h7v7l9-11h-7z\"\n              />\n            </svg>\n            Tools\n          </a>\n\n          <a\n            href=\"/about\"\n            className=\"flex items-center gap-2 w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\n            onClick={() => setIsOpen(false)}\n          >\n            <svg\n              className=\"w-4 h-4\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M13 16h-1v-4h-1m1-4h.01M12 2a10 10 0 100 20 10 10 0 000-20z\"\n              />\n            </svg>\n            About\n          </a>\n\n          <a\n            href=\"/faq\"\n            className=\"flex items-center gap-2 w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\n            onClick={() => setIsOpen(false)}\n          >\n            <svg\n              className=\"w-4 h-4\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"\n              />\n            </svg>\n            FAQ\n          </a>\n\n          <button\n            type=\"button\"\n            onClick={() => {\n              setIsOpen(false);\n              onLogout();\n            }}\n            className=\"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\n          >\n            Logout\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n", "import { useState } from \"react\";\nimport { AddTag } from \"./AddTag.tsx\";\nimport { EditTag } from \"./EditTag.tsx\";\nimport { useApp } from \"../context/AppContext.tsx\";\nimport { encodeTagsForUrl } from \"../../shared/utils.ts\";\n\nexport function TagSidebar() {\n  const {\n    tags,\n    selectedTags,\n    toggleTag,\n    clearFilters,\n    loadTags: loadTagsFromContext,\n    addTag,\n    updateTag,\n    deleteTag,\n    session,\n  } = useApp();\n\n  // Data is pre-loaded by App.tsx via loadInitialData(), so no initial loading state\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [editingTag, setEditingTag] = useState<any>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [refreshing, setRefreshing] = useState(false);\n\n  // Manual refresh (for retry button)\n  async function loadTags() {\n    setRefreshing(true);\n    setError(null);\n    try {\n      await loadTagsFromContext();\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setRefreshing(false);\n    }\n  }\n\n  function handleTagAdded(tag: any) {\n    addTag(tag);\n    setShowAddModal(false);\n  }\n\n  function handleTagUpdated(updatedTag: any) {\n    updateTag(updatedTag);\n    setEditingTag(null);\n  }\n\n  function handleTagDeleted(tagUri: string) {\n    deleteTag(tagUri);\n    setEditingTag(null);\n  }\n\n  async function handleShareFiltered() {\n    if (!session || selectedTags.size === 0) return;\n\n    try {\n      // Generate share URL\n      const encodedTags = encodeTagsForUrl([...selectedTags]);\n      const shareUrl =\n        `${globalThis.location.origin}/share/${session.did}/${encodedTags}`;\n\n      // Use Web Share API if available\n      if (navigator.share) {\n        await navigator.share({\n          title: \"My Kipclip Bookmarks Collection\",\n          text: `Check out my bookmarks collection tagged with: ${\n            [...selectedTags].join(\", \")\n          }`,\n          url: shareUrl,\n        });\n      } else {\n        // Fallback: copy to clipboard\n        await navigator.clipboard.writeText(shareUrl);\n        alert(\"Share link copied to clipboard!\");\n      }\n    } catch (err: any) {\n      // User cancelled or share failed\n      if (err.name !== \"AbortError\") {\n        console.error(\"Share failed:\", err);\n        alert(\"Failed to share link\");\n      }\n    }\n  }\n\n  // Shared tag item renderer\n  function renderTag(tag: any) {\n    const isSelected = selectedTags.has(tag.value);\n    return (\n      <li\n        key={tag.uri}\n        className={`group flex items-center justify-between gap-2 px-3 py-2 rounded-lg transition text-sm whitespace-nowrap flex-shrink-0 cursor-pointer ${\n          isSelected\n            ? \"bg-blue-600 text-white hover:bg-blue-700\"\n            : \"text-gray-700 hover:bg-gray-100\"\n        }`}\n        title={`Created ${new Date(tag.createdAt).toLocaleDateString()}`}\n        onClick={() => {\n          toggleTag(tag.value);\n        }}\n      >\n        <div className=\"flex items-center gap-2\">\n          {isSelected && (\n            <svg\n              className=\"w-4 h-4\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M5 13l4 4L19 7\"\n              />\n            </svg>\n          )}\n          <span>{tag.value}</span>\n        </div>\n        <div className=\"flex items-center gap-1\">\n          <button\n            type=\"button\"\n            onClick={(e) => {\n              e.stopPropagation();\n              setEditingTag(tag);\n            }}\n            className={`opacity-0 group-hover:opacity-100 transition p-1 rounded flex-shrink-0 ${\n              isSelected ? \"hover:bg-blue-500\" : \"hover:bg-gray-200\"\n            }`}\n            title=\"Edit tag\"\n          >\n            <svg\n              className={`w-4 h-4 ${\n                isSelected ? \"text-white\" : \"text-gray-600\"\n              }`}\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z\"\n              />\n            </svg>\n          </button>\n          <button\n            type=\"button\"\n            draggable=\"true\"\n            onClick={(e) => {\n              e.stopPropagation();\n            }}\n            onDragStart={(e) => {\n              e.stopPropagation();\n              e.dataTransfer.effectAllowed = \"copy\";\n              e.dataTransfer.setData(\"text/plain\", tag.value);\n              const listItem = (e.target as HTMLElement).closest(\"li\");\n              if (listItem) {\n                // Set the drag image to the entire tag card\n                e.dataTransfer.setDragImage(listItem, 20, 20);\n                listItem.style.opacity = \"0.5\";\n              }\n            }}\n            onDragEnd={(e) => {\n              e.stopPropagation();\n              const listItem = (e.target as HTMLElement).closest(\"li\");\n              if (listItem) {\n                listItem.style.opacity = \"1\";\n              }\n            }}\n            className={`opacity-0 group-hover:opacity-100 transition p-1 rounded cursor-grab active:cursor-grabbing flex-shrink-0 ${\n              isSelected ? \"hover:bg-blue-500\" : \"hover:bg-gray-200\"\n            }`}\n            title=\"Drag to bookmark to tag it\"\n          >\n            <svg\n              className={`w-4 h-4 ${\n                isSelected ? \"text-white\" : \"text-gray-600\"\n              }`}\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M4 8h16M4 16h16\"\n              />\n            </svg>\n          </button>\n        </div>\n      </li>\n    );\n  }\n\n  return (\n    <>\n      {/* Mobile: Horizontal sticky bar */}\n      <div\n        style={{ backgroundColor: \"var(--sidebar-bg)\" }}\n        className=\"md:hidden w-full sticky top-0 z-10 border-b border-gray-200\"\n      >\n        <div className=\"flex items-center gap-3 px-3 py-3 overflow-x-auto\">\n          <h2 className=\"text-sm font-bold text-gray-800 flex-shrink-0\">\n            Tags\n          </h2>\n          {error\n            ? (\n              <div className=\"flex-1 text-xs text-red-600 flex-shrink-0\">\n                {error}\n              </div>\n            )\n            : tags.length === 0\n            ? (\n              <div className=\"flex-1 text-xs text-gray-500 flex-shrink-0\">\n                No tags yet\n              </div>\n            )\n            : (\n              <ul className=\"flex gap-2 flex-shrink-0\">\n                {tags.map(renderTag)}\n              </ul>\n            )}\n          {selectedTags.size > 0 && (\n            <>\n              <button\n                type=\"button\"\n                onClick={clearFilters}\n                className=\"flex-shrink-0 px-3 py-1 text-xs bg-gray-200 hover:bg-gray-300 rounded-lg transition text-gray-700 font-medium\"\n                title=\"Clear all filters\"\n              >\n                Clear filters\n              </button>\n              <button\n                type=\"button\"\n                onClick={handleShareFiltered}\n                className=\"flex-shrink-0 px-3 py-1 text-xs rounded-lg transition text-white font-medium flex items-center gap-1\"\n                style={{ backgroundColor: \"var(--coral)\" }}\n                title=\"Share these filtered bookmarks\"\n              >\n                <svg\n                  className=\"w-3 h-3\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z\"\n                  />\n                </svg>\n                Share\n              </button>\n            </>\n          )}\n          <button\n            type=\"button\"\n            onClick={() => setShowAddModal(true)}\n            className=\"flex-shrink-0 ml-auto p-2 hover:bg-gray-100 rounded-lg transition text-gray-600\"\n            title=\"Create tag\"\n          >\n            <svg\n              className=\"w-5 h-5\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              viewBox=\"0 0 24 24\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M12 4v16m8-8H4\"\n              />\n            </svg>\n          </button>\n        </div>\n      </div>\n\n      {/* Desktop: Vertical sidebar */}\n      <aside\n        style={{ backgroundColor: \"var(--sidebar-bg)\" }}\n        className=\"hidden md:flex md:flex-col w-64 border-r border-gray-200 p-4\"\n      >\n        <div className=\"mb-4\">\n          <h2 className=\"text-lg font-bold text-gray-800 mb-3\">Tags</h2>\n          <button\n            type=\"button\"\n            onClick={() => setShowAddModal(true)}\n            className=\"w-full btn-primary text-sm py-2 px-4\"\n          >\n            + Create Tag\n          </button>\n        </div>\n\n        {selectedTags.size > 0 && (\n          <div className=\"mb-4 space-y-2\">\n            <button\n              type=\"button\"\n              onClick={clearFilters}\n              className=\"w-full px-3 py-2 text-sm bg-gray-200 hover:bg-gray-300 rounded-lg transition text-gray-700 font-medium\"\n              title=\"Clear all filters\"\n            >\n              Clear filters ({selectedTags.size})\n            </button>\n            <button\n              type=\"button\"\n              onClick={handleShareFiltered}\n              className=\"w-full px-3 py-2 text-sm rounded-lg transition text-white font-medium flex items-center justify-center gap-2\"\n              style={{ backgroundColor: \"var(--coral)\" }}\n              title=\"Share these filtered bookmarks\"\n            >\n              <svg\n                className=\"w-4 h-4\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z\"\n                />\n              </svg>\n              Share collection\n            </button>\n          </div>\n        )}\n\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded text-xs mb-4\">\n            {error}\n            <button\n              type=\"button\"\n              onClick={() => loadTags()}\n              disabled={refreshing}\n              className=\"block mt-2 underline disabled:opacity-50\"\n            >\n              {refreshing ? \"Loading...\" : \"Try Again\"}\n            </button>\n          </div>\n        )}\n\n        <div className=\"flex-1 overflow-y-auto\">\n          {tags.length === 0\n            ? (\n              <div className=\"text-center py-10 text-gray-500 text-sm\">\n                <p className=\"mb-2\">No tags yet</p>\n                <p className=\"text-xs\">Create your first tag to get started</p>\n              </div>\n            )\n            : <ul className=\"space-y-1\">{tags.map(renderTag)}</ul>}\n        </div>\n      </aside>\n\n      {showAddModal && (\n        <AddTag\n          onClose={() => setShowAddModal(false)}\n          onTagAdded={handleTagAdded}\n        />\n      )}\n\n      {editingTag && (\n        <EditTag\n          tag={editingTag}\n          onClose={() => setEditingTag(null)}\n          onTagUpdated={handleTagUpdated}\n          onTagDeleted={handleTagDeleted}\n        />\n      )}\n    </>\n  );\n}\n", "import { useState } from \"react\";\nimport type { EnrichedTag } from \"../../shared/types.ts\";\n\ninterface AddTagProps {\n  onClose: () => void;\n  onTagAdded: (tag: EnrichedTag) => void;\n}\n\nexport function AddTag({ onClose, onTagAdded }: AddTagProps) {\n  const [value, setValue] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n    if (!value.trim()) return;\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const response = await fetch(\"/api/tags\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ value: value.trim() }),\n      });\n\n      if (!response.ok) {\n        const data = await response.json();\n        throw new Error(data.error || \"Failed to add tag\");\n      }\n\n      const data = await response.json();\n      onTagAdded(data.tag);\n    } catch (err: any) {\n      setError(err.message);\n      setLoading(false);\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50\">\n      <div className=\"bg-white rounded-lg max-w-md w-full p-6 fade-in\">\n        <div className=\"flex items-center justify-between mb-4\">\n          <h3 className=\"text-xl font-bold text-gray-800\">Create Tag</h3>\n          <button\n            type=\"button\"\n            onClick={onClose}\n            className=\"text-gray-400 hover:text-gray-600 text-2xl\"\n            disabled={loading}\n          >\n            \u00D7\n          </button>\n        </div>\n\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <label\n              htmlFor=\"tag-value\"\n              className=\"block text-sm font-medium text-gray-700 mb-2\"\n            >\n              Tag Name\n            </label>\n            <input\n              type=\"text\"\n              id=\"tag-value\"\n              value={value}\n              onChange={(e) => setValue(e.target.value)}\n              placeholder=\"e.g., work, personal, reading\"\n              maxLength={64}\n              className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-coral focus:border-transparent outline-none transition\"\n              disabled={loading}\n              autoFocus\n              required\n            />\n            <p className=\"text-xs text-gray-500 mt-1\">\n              {value.length}/64 characters\n            </p>\n          </div>\n\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"flex gap-3\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"flex-1 px-4 py-3 rounded-lg border border-gray-300 text-gray-700 font-medium hover:bg-gray-50 transition\"\n              disabled={loading}\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              className=\"flex-1 btn-primary disabled:opacity-50\"\n              disabled={loading || !value.trim()}\n            >\n              {loading\n                ? (\n                  <span className=\"flex items-center justify-center gap-2\">\n                    <div className=\"spinner w-5 h-5 border-2\"></div>\n                    Creating...\n                  </span>\n                )\n                : (\n                  \"Create Tag\"\n                )}\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n", "import { useState } from \"react\";\nimport type { EnrichedTag } from \"../../shared/types.ts\";\nimport { useApp } from \"../context/AppContext.tsx\";\n\ninterface EditTagProps {\n  tag: EnrichedTag;\n  onClose: () => void;\n  onTagUpdated: (tag: EnrichedTag) => void;\n  onTagDeleted: (tagUri: string) => void;\n}\n\nexport function EditTag(\n  { tag, onClose, onTagUpdated, onTagDeleted }: EditTagProps,\n) {\n  const { loadBookmarks } = useApp();\n  const [value, setValue] = useState(tag.value);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Extract rkey from URI (format: at://did:plc:xxx/com.kipclip.tag/rkey)\n  const rkey = tag.uri.split(\"/\").pop()!;\n\n  async function handleSubmit(e: React.FormEvent) {\n    e.preventDefault();\n\n    if (!value.trim()) {\n      setError(\"Tag value cannot be empty\");\n      return;\n    }\n\n    const newValue = value.trim();\n    const hasChanged = newValue !== tag.value;\n\n    if (!hasChanged) {\n      // No change, just close\n      onClose();\n      return;\n    }\n\n    setIsSubmitting(true);\n    setError(null);\n\n    try {\n      const response = await fetch(`/api/tags/${rkey}`, {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ value: newValue }),\n      });\n\n      if (!response.ok) {\n        const data = await response.json();\n        throw new Error(data.error || \"Failed to update tag\");\n      }\n\n      const data = await response.json();\n\n      // Refresh bookmarks since tag was renamed on them\n      if (hasChanged) {\n        await loadBookmarks();\n      }\n\n      if (data.tag) {\n        onTagUpdated(data.tag);\n      }\n    } catch (err: any) {\n      setError(err.message);\n      setIsSubmitting(false);\n    }\n  }\n\n  async function handleDelete() {\n    setIsDeleting(true);\n    setError(null);\n\n    try {\n      // First, fetch usage count\n      const usageResponse = await fetch(`/api/tags/${rkey}/usage`);\n      if (!usageResponse.ok) {\n        throw new Error(\"Failed to check tag usage\");\n      }\n\n      const usageData = await usageResponse.json();\n      const count = usageData.count || 0;\n\n      // Show detailed confirmation\n      let confirmMessage = `Delete tag \"${tag.value}\"?`;\n      if (count > 0) {\n        confirmMessage += `\\n\\nThis tag is used on ${count} bookmark${\n          count === 1 ? \"\" : \"s\"\n        } and will be removed from ${count === 1 ? \"it\" : \"all of them\"}.`;\n        confirmMessage += \"\\n\\nThis action cannot be undone.\";\n      }\n\n      if (!confirm(confirmMessage)) {\n        setIsDeleting(false);\n        return;\n      }\n\n      // Delete the tag (backend will remove from bookmarks)\n      const deleteResponse = await fetch(`/api/tags/${rkey}`, {\n        method: \"DELETE\",\n      });\n\n      if (!deleteResponse.ok) {\n        const data = await deleteResponse.json();\n        throw new Error(data.error || \"Failed to delete tag\");\n      }\n\n      // Refresh bookmarks if any were affected\n      if (count > 0) {\n        await loadBookmarks();\n      }\n\n      onTagDeleted(tag.uri);\n    } catch (err: any) {\n      setError(err.message);\n      setIsDeleting(false);\n    }\n  }\n\n  return (\n    <div\n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\"\n      onClick={onClose}\n    >\n      <div\n        className=\"bg-white rounded-lg shadow-xl max-w-md w-full p-6\"\n        onClick={(e) => e.stopPropagation()}\n      >\n        <h2 className=\"text-xl font-bold text-gray-800 mb-4\">Edit Tag</h2>\n\n        <form onSubmit={handleSubmit}>\n          <div className=\"mb-4\">\n            <label\n              htmlFor=\"tag-value\"\n              className=\"block text-sm font-medium text-gray-700 mb-2\"\n            >\n              Tag Value\n            </label>\n            <input\n              id=\"tag-value\"\n              type=\"text\"\n              value={value}\n              onChange={(e) => setValue(e.target.value)}\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              placeholder=\"Enter tag value\"\n              maxLength={64}\n              disabled={isSubmitting || isDeleting}\n              autoFocus\n            />\n            <p className=\"text-xs text-gray-500 mt-1\">\n              {value.length}/64 characters\n            </p>\n          </div>\n\n          {error && (\n            <div className=\"mb-4 bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded text-sm\">\n              {error}\n            </div>\n          )}\n\n          <div className=\"flex gap-2 justify-between\">\n            <button\n              type=\"button\"\n              onClick={handleDelete}\n              disabled={isSubmitting || isDeleting}\n              className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition text-sm font-medium\"\n            >\n              {isDeleting ? \"Deleting...\" : \"Delete\"}\n            </button>\n\n            <div className=\"flex gap-2\">\n              <button\n                type=\"button\"\n                onClick={onClose}\n                disabled={isSubmitting || isDeleting}\n                className=\"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition text-sm font-medium\"\n              >\n                Cancel\n              </button>\n              <button\n                type=\"submit\"\n                disabled={isSubmitting || isDeleting || !value.trim()}\n                className=\"px-4 py-2 btn-primary disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium\"\n              >\n                {isSubmitting ? \"Saving...\" : \"Save\"}\n              </button>\n            </div>\n          </div>\n        </form>\n      </div>\n    </div>\n  );\n}\n", "// Shared utility functions for kipclip\n\n/**\n * Encodes an array of tags into a URL-safe string\n * Tags are sorted for consistency, then base64 encoded\n */\nexport function encodeTagsForUrl(tags: string[]): string {\n  if (tags.length === 0) {\n    throw new Error(\"Cannot encode empty tags array\");\n  }\n\n  // Sort tags for consistent encoding regardless of order\n  const sorted = [...tags].sort();\n\n  // Join with a delimiter\n  const joined = sorted.join(\"|\");\n\n  // Encode to base64 and make URL-safe\n  const base64 = btoa(joined);\n  const urlSafe = base64\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\")\n    .replace(/=/g, \"~\");\n\n  return urlSafe;\n}\n\n/**\n * Decodes a URL-safe encoded string back into an array of tags\n */\nexport function decodeTagsFromUrl(encoded: string): string[] {\n  try {\n    // Convert from URL-safe back to standard base64\n    const base64 = encoded\n      .replace(/-/g, \"+\")\n      .replace(/_/g, \"/\")\n      .replace(/~/g, \"=\");\n\n    // Decode from base64\n    const joined = atob(base64);\n\n    // Split by delimiter\n    const tags = joined.split(\"|\");\n\n    // Validate we got at least one tag\n    if (tags.length === 0 || tags[0] === \"\") {\n      throw new Error(\"No valid tags found\");\n    }\n\n    return tags;\n  } catch (err) {\n    throw new Error(`Invalid encoded tags: ${err.message}`);\n  }\n}\n", "import { useEffect, useRef, useState } from \"react\";\n\nexport function Tools() {\n  const [copied, setCopied] = useState(false);\n  const bookmarkletContainerRef = useRef<HTMLDivElement>(null);\n\n  const bookmarkletCode =\n    `javascript:(function(){window.open('https://kipclip.com/save?url='+encodeURIComponent(location.href),'kipclip','width=600,height=700')})()`;\n\n  useEffect(() => {\n    // Set href directly on DOM element after render to bypass React\n    if (bookmarkletContainerRef.current) {\n      const anchor = bookmarkletContainerRef.current.querySelector(\"a\");\n      if (anchor) {\n        anchor.href = bookmarkletCode;\n      }\n    }\n  }, [bookmarkletCode]);\n\n  async function handleCopy() {\n    try {\n      await navigator.clipboard.writeText(bookmarkletCode);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    } catch (err) {\n      console.error(\"Failed to copy:\", err);\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <header className=\"bg-white shadow-sm\">\n        <div className=\"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between\">\n          <a href=\"/\" className=\"flex items-center gap-2\">\n            <img\n              src=\"https://res.cloudinary.com/dru3aznlk/image/upload/v1760692589/kip-vignette_h2jwct.png\"\n              alt=\"Kip logo\"\n              className=\"w-8 h-8\"\n            />\n            <h1\n              className=\"text-2xl font-bold\"\n              style={{ color: \"var(--coral)\" }}\n            >\n              kipclip\n            </h1>\n          </a>\n          <a\n            href=\"/\"\n            className=\"text-gray-600 hover:text-gray-800 text-sm font-medium\"\n          >\n            Back to Bookmarks\n          </a>\n        </div>\n      </header>\n\n      <main className=\"max-w-4xl mx-auto px-4 py-12\">\n        <div className=\"mb-8\">\n          <h2 className=\"text-3xl font-bold text-gray-800 mb-3\">\n            Save from Anywhere\n          </h2>\n          <p className=\"text-gray-600 text-lg\">\n            Add bookmarks to kipclip from any website with these tools\n          </p>\n        </div>\n\n        {/* Bookmarklet Section */}\n        <div className=\"bg-white rounded-lg shadow-md p-8 mb-8\">\n          <div className=\"flex items-start gap-3 mb-6\">\n            <div className=\"w-10 h-10 bg-coral/10 rounded-lg flex items-center justify-center flex-shrink-0\">\n              <svg\n                className=\"w-6 h-6\"\n                style={{ color: \"var(--coral)\" }}\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M13 10V3L4 14h7v7l9-11h-7z\"\n                />\n              </svg>\n            </div>\n            <div>\n              <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n                Browser Bookmarklet\n              </h3>\n              <p className=\"text-gray-600\">\n                Works on all desktop browsers (Chrome, Firefox, Safari, Edge)\n              </p>\n            </div>\n          </div>\n\n          {/* Draggable Bookmarklet */}\n          <div className=\"mb-6\">\n            <div className=\"bg-gray-50 border-2 border-dashed border-gray-300 rounded-lg p-6 text-center\">\n              <p className=\"text-sm text-gray-600 mb-4 font-medium\">\n                Drag this button to your bookmarks bar:\n              </p>\n              <div ref={bookmarkletContainerRef}>\n                <a\n                  href=\"\"\n                  onClick={(e) => e.preventDefault()}\n                  className=\"inline-flex items-center gap-2 px-6 py-3 rounded-lg font-bold text-white shadow-lg hover:shadow-xl transition-shadow cursor-move select-none\"\n                  style={{ backgroundColor: \"var(--coral)\" }}\n                  draggable=\"true\"\n                >\n                  <svg\n                    className=\"w-5 h-5\"\n                    fill=\"none\"\n                    stroke=\"currentColor\"\n                    viewBox=\"0 0 24 24\"\n                  >\n                    <path\n                      strokeLinecap=\"round\"\n                      strokeLinejoin=\"round\"\n                      strokeWidth={2}\n                      d=\"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z\"\n                    />\n                  </svg>\n                  Kip it\n                </a>\n              </div>\n            </div>\n          </div>\n\n          {/* Instructions */}\n          <div className=\"space-y-4 mb-6\">\n            <div>\n              <h4 className=\"font-semibold text-gray-800 mb-2\">\n                How to install:\n              </h4>\n              <ol className=\"space-y-2 text-sm text-gray-700\">\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"font-bold text-coral min-w-[20px]\">1.</span>\n                  <span>\n                    Make sure your bookmarks bar is visible (press{\" \"}\n                    <kbd className=\"px-2 py-1 bg-gray-200 rounded text-xs font-mono\">\n                      Cmd+Shift+B\n                    </kbd>{\" \"}\n                    or{\" \"}\n                    <kbd className=\"px-2 py-1 bg-gray-200 rounded text-xs font-mono\">\n                      Ctrl+Shift+B\n                    </kbd>)\n                  </span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"font-bold text-coral min-w-[20px]\">2.</span>\n                  <span>\n                    Drag the \"Kip it\" button above to your bookmarks bar\n                  </span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"font-bold text-coral min-w-[20px]\">3.</span>\n                  <span>\n                    When you're on a page you want to save, click the\n                    bookmarklet in your bookmarks bar\n                  </span>\n                </li>\n              </ol>\n            </div>\n          </div>\n\n          {/* Alternative Methods */}\n          <div className=\"border-t pt-6\">\n            <h4 className=\"font-semibold text-gray-800 mb-3\">\n              Alternative installation methods:\n            </h4>\n            <div className=\"space-y-3 text-sm\">\n              <div className=\"bg-gray-50 rounded-lg p-4\">\n                <p className=\"text-gray-700 mb-2\">\n                  <strong>Method 2:</strong>{\" \"}\n                  Right-click the button above and select \"Bookmark This Link\"\n                  or \"Add to Bookmarks\"\n                </p>\n              </div>\n              <div className=\"bg-gray-50 rounded-lg p-4\">\n                <p className=\"text-gray-700 mb-3\">\n                  <strong>Method 3:</strong>{\" \"}\n                  Copy the code and create a bookmark manually:\n                </p>\n                <div className=\"flex gap-2\">\n                  <code className=\"flex-1 bg-white px-3 py-2 rounded border text-xs overflow-x-auto\">\n                    {bookmarkletCode}\n                  </code>\n                  <button\n                    type=\"button\"\n                    onClick={handleCopy}\n                    className=\"px-4 py-2 bg-gray-800 text-white rounded hover:bg-gray-700 transition flex-shrink-0\"\n                  >\n                    {copied ? \"Copied!\" : \"Copy\"}\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Mobile Section */}\n        <div className=\"bg-white rounded-lg shadow-md p-8\">\n          <div className=\"flex items-start gap-3 mb-6\">\n            <div className=\"w-10 h-10 bg-coral/10 rounded-lg flex items-center justify-center flex-shrink-0\">\n              <svg\n                className=\"w-6 h-6\"\n                style={{ color: \"var(--coral)\" }}\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z\"\n                />\n              </svg>\n            </div>\n            <div>\n              <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n                Mobile Devices\n              </h3>\n              <p className=\"text-gray-600\">\n                Save bookmarks from your phone or tablet\n              </p>\n            </div>\n          </div>\n\n          <div className=\"space-y-4\">\n            <div className=\"bg-gray-50 rounded-lg p-4\">\n              <h4 className=\"font-semibold text-gray-800 mb-3\">\n                iOS Shortcut (Recommended):\n              </h4>\n              <p className=\"text-sm text-gray-700 mb-4\">\n                Install the \"Kip it\" shortcut to save bookmarks from Safari's\n                share menu with one tap.\n              </p>\n              <a\n                href=\"https://www.icloud.com/shortcuts/284a2a52e6cb46cc96ebed6f54fc0dfd\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"inline-flex items-center gap-2 px-6 py-3 rounded-lg font-bold text-white shadow-lg hover:shadow-xl transition-shadow\"\n                style={{ backgroundColor: \"var(--coral)\" }}\n              >\n                <svg\n                  className=\"w-5 h-5\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z\"\n                  />\n                </svg>\n                Get iOS Shortcut\n              </a>\n              <p className=\"text-xs text-gray-600 mt-3\">\n                After installing, \"Kip it\" will appear in your share menu when\n                viewing web pages in Safari.\n              </p>\n            </div>\n\n            <div className=\"bg-gray-50 rounded-lg p-4\">\n              <h4 className=\"font-semibold text-gray-800 mb-2\">\n                Android (Chrome):\n              </h4>\n              <ol className=\"space-y-2 text-sm text-gray-700\">\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"font-bold text-coral min-w-[20px]\">1.</span>\n                  <span>Open kipclip.com in Chrome</span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"font-bold text-coral min-w-[20px]\">2.</span>\n                  <span>\n                    Tap the menu (\u22EE), then \"Add to Home screen\"\n                  </span>\n                </li>\n                <li className=\"flex items-start gap-2\">\n                  <span className=\"font-bold text-coral min-w-[20px]\">3.</span>\n                  <span>\n                    When sharing URLs from other apps, kipclip will appear as a\n                    share target\n                  </span>\n                </li>\n              </ol>\n            </div>\n          </div>\n        </div>\n\n        {/* Help Section */}\n        <div className=\"mt-8 text-center text-sm text-gray-600\">\n          <p>\n            Need help?{\" \"}\n            <a\n              href=\"/\"\n              className=\"font-medium hover:underline\"\n              style={{ color: \"var(--coral)\" }}\n            >\n              Contact us\n            </a>\n          </p>\n        </div>\n      </main>\n    </div>\n  );\n}\n", "export function About() {\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <header className=\"bg-white shadow-sm\">\n        <div className=\"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between\">\n          <a href=\"/\" className=\"flex items-center gap-2\">\n            <img\n              src=\"https://res.cloudinary.com/dru3aznlk/image/upload/v1760692589/kip-vignette_h2jwct.png\"\n              alt=\"Kip logo\"\n              className=\"w-8 h-8\"\n            />\n            <h1\n              className=\"text-2xl font-bold\"\n              style={{ color: \"var(--coral)\" }}\n            >\n              kipclip\n            </h1>\n          </a>\n          <a\n            href=\"/\"\n            className=\"text-gray-600 hover:text-gray-800 text-sm font-medium\"\n          >\n            Back to Bookmarks\n          </a>\n        </div>\n      </header>\n\n      <main className=\"max-w-4xl mx-auto px-4 py-12 space-y-8\">\n        <section>\n          <h2 className=\"text-3xl font-bold text-gray-800 mb-3\">\n            About kipclip\n          </h2>\n          <p className=\"text-gray-700 text-lg\">\n            kipclip is a simple, open bookmarks app for the AT Protocol. Save\n            links you care about, organize them with tags, and browse them from\n            any device.\n          </p>\n        </section>\n\n        <section className=\"bg-white rounded-lg shadow-md p-6 space-y-3\">\n          <h3 className=\"text-xl font-bold text-gray-800\">How it works</h3>\n          <ul className=\"list-disc pl-5 text-gray-700 space-y-2\">\n            <li>\n              Your bookmarks are saved as AT Protocol records in your own PDS\n              (Personal Data Server) under your account.\n            </li>\n            <li>\n              kipclip uses a community lexicon (schema) so other AT Protocol\n              apps can read these records too.\n            </li>\n            <li>\n              The app UI is a lightweight web client; the data lives with you in\n              your PDS.\n            </li>\n          </ul>\n        </section>\n\n        <section className=\"bg-white rounded-lg shadow-md p-6 space-y-3\">\n          <h3 className=\"text-xl font-bold text-gray-800\">\n            Important note on privacy\n          </h3>\n          <p className=\"text-gray-700\">\n            AT Protocol records are public by default. That means bookmarks you\n            save with kipclip are public and discoverable. Please don\u2019t save\n            anything sensitive or private.\n          </p>\n        </section>\n\n        <section className=\"bg-white rounded-lg shadow-md p-6 space-y-3\">\n          <h3 className=\"text-xl font-bold text-gray-800\">Have questions?</h3>\n          <p className=\"text-gray-700\">\n            Check out our{\" \"}\n            <a\n              href=\"/faq\"\n              className=\"underline hover:text-gray-800\"\n            >\n              Frequently Asked Questions\n            </a>{\" \"}\n            page to learn more about AT Protocol, login, data storage, and more.\n          </p>\n        </section>\n\n        <section className=\"bg-white rounded-lg shadow-md p-6\">\n          <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Links</h3>\n          <div className=\"flex flex-col sm:flex-row gap-3\">\n            <a\n              href=\"https://github.com/tijs/kipclip-appview\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"inline-flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-white hover:opacity-95\"\n              style={{ backgroundColor: \"var(--coral)\" }}\n            >\n              <svg\n                className=\"w-5 h-5\"\n                viewBox=\"0 0 24 24\"\n                fill=\"currentColor\"\n                aria-hidden\n              >\n                <path d=\"M12 .5C5.73.5.94 5.29.94 11.56c0 4.86 3.15 8.98 7.52 10.43.55.1.75-.24.75-.53 0-.26-.01-1.12-.02-2.03-3.06.67-3.71-1.3-3.71-1.3-.5-1.28-1.23-1.63-1.23-1.63-1.01-.69.08-.68.08-.68 1.12.08 1.71 1.15 1.71 1.15.99 1.7 2.6 1.21 3.23.93.1-.72.39-1.21.71-1.49-2.44-.28-5-1.22-5-5.43 0-1.2.43-2.18 1.14-2.95-.11-.28-.5-1.43.11-2.98 0 0 .94-.3 3.07 1.13.89-.25 1.85-.37 2.81-.37.95 0 1.92.12 2.81.37 2.12-1.43 3.06-1.13 3.06-1.13.62 1.55.23 2.7.12 2.98.71.77 1.14 1.75 1.14 2.95 0 4.22-2.57 5.15-5.01 5.42.4.35.76 1.04.76 2.1 0 1.52-.01 2.74-.01 3.12 0 .29.2.64.76.53 4.36-1.45 7.51-5.57 7.51-10.43C23.06 5.29 18.27.5 12 .5z\" />\n              </svg>\n              GitHub Repository\n            </a>\n            <a\n              href=\"https://ko-fi.com/tijsteulings/tip\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"inline-flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-white hover:opacity-95\"\n              style={{ backgroundColor: \"#13C3FF\" }}\n            >\n              <img\n                src=\"https://storage.ko-fi.com/cdn/brandasset/v2/kofi_symbol.png\"\n                alt=\"Ko-fi\"\n                className=\"w-5 h-5\"\n              />\n              Support this project\n            </a>\n            <a\n              href=\"https://bsky.app/profile/tijs.org\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"inline-flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-white hover:opacity-95\"\n              style={{ backgroundColor: \"#1185FF\" }}\n            >\n              <span aria-hidden className=\"text-lg\">\uD83E\uDD8B</span>\n              made bij tijs.org\n            </a>\n          </div>\n        </section>\n      </main>\n    </div>\n  );\n}\n", "import { useEffect, useState } from \"react\";\n\nexport function Save() {\n  const [session, setSession] = useState<\n    { did: string; handle: string } | null\n  >(null);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [saved, setSaved] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [url, setUrl] = useState(\"\");\n\n  useEffect(() => {\n    // Get URL from query params\n    const params = new URLSearchParams(globalThis.location.search);\n    const urlParam = params.get(\"url\");\n    if (urlParam) {\n      setUrl(urlParam);\n    }\n\n    // Check session\n    checkSession();\n  }, []);\n\n  async function checkSession() {\n    try {\n      const response = await fetch(\"/api/auth/session\", {\n        credentials: \"include\",\n      });\n      if (response.ok) {\n        const data = await response.json();\n        setSession({\n          did: data.did,\n          handle: data.handle,\n        });\n      } else {\n        // Session check failed - log for debugging\n        console.warn(\"Session check failed:\", {\n          status: response.status,\n          statusText: response.statusText,\n        });\n\n        // Try to get error details\n        try {\n          const errorData = await response.json();\n          console.warn(\"Session error details:\", errorData);\n        } catch {\n          // Ignore JSON parse errors\n        }\n      }\n    } catch (error) {\n      console.error(\"Failed to check session:\", error);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  async function handleSave(e: React.FormEvent) {\n    e.preventDefault();\n    if (!url.trim()) return;\n\n    setSaving(true);\n    setError(null);\n\n    try {\n      const response = await fetch(\"/api/bookmarks\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        credentials: \"include\",\n        body: JSON.stringify({ url: url.trim() }),\n      });\n\n      // If session expired, redirect to login with current page\n      if (response.status === 401) {\n        // Log error details for debugging\n        try {\n          const errorData = await response.json();\n          console.warn(\"Authentication error during save:\", errorData);\n        } catch {\n          // Ignore JSON parse errors\n        }\n\n        const loginUrl = `/login?redirect=${\n          encodeURIComponent(\n            globalThis.location.pathname + globalThis.location.search,\n          )\n        }`;\n        globalThis.location.href = loginUrl;\n        return;\n      }\n\n      if (!response.ok) {\n        const data = await response.json();\n        console.error(\"Failed to save bookmark:\", data);\n        throw new Error(data.message || data.error || \"Failed to add bookmark\");\n      }\n\n      setSaved(true);\n    } catch (err: any) {\n      setError(err.message);\n      setSaving(false);\n    }\n  }\n\n  function handleClose() {\n    globalThis.close();\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-gray-50\">\n        <div className=\"spinner\"></div>\n      </div>\n    );\n  }\n\n  if (!session) {\n    const loginUrl = `/?redirect=${\n      encodeURIComponent(\n        globalThis.location.pathname + globalThis.location.search,\n      )\n    }`;\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-gray-50 p-4\">\n        <div className=\"bg-white rounded-lg max-w-md w-full p-8 shadow-lg text-center\">\n          <div className=\"mb-6\">\n            <img\n              src=\"https://res.cloudinary.com/dru3aznlk/image/upload/v1760692589/kip-vignette_h2jwct.png\"\n              alt=\"Kip logo\"\n              className=\"w-16 h-16 mx-auto mb-4\"\n            />\n            <h1 className=\"text-2xl font-bold text-gray-800 mb-2\">\n              Login Required\n            </h1>\n            <p className=\"text-gray-600\">\n              Sign in to save bookmarks to kipclip\n            </p>\n          </div>\n\n          <a\n            href={loginUrl}\n            className=\"inline-block w-full btn-primary py-3 px-4 rounded-lg text-center\"\n          >\n            Sign in\n          </a>\n        </div>\n      </div>\n    );\n  }\n\n  if (saved) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen bg-gray-50 p-4\">\n        <div className=\"bg-white rounded-lg max-w-md w-full p-8 shadow-lg text-center\">\n          <div className=\"mb-6\">\n            <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <svg\n                className=\"w-8 h-8 text-green-600\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M5 13l4 4L19 7\"\n                />\n              </svg>\n            </div>\n            <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">\n              Bookmark Saved!\n            </h2>\n            <p className=\"text-gray-600 mb-6\">\n              Your bookmark has been saved to kipclip\n            </p>\n          </div>\n\n          <div className=\"space-y-3\">\n            <button\n              type=\"button\"\n              onClick={handleClose}\n              className=\"w-full px-4 py-3 rounded-lg border border-gray-300 text-gray-700 font-medium hover:bg-gray-50 transition\"\n            >\n              Close Window\n            </button>\n            <a\n              href=\"/\"\n              className=\"block w-full px-4 py-3 rounded-lg btn-primary text-center\"\n            >\n              View All Bookmarks\n            </a>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex items-center justify-center min-h-screen bg-gray-50 p-4\">\n      <div className=\"bg-white rounded-lg max-w-md w-full p-6 shadow-lg\">\n        <div className=\"flex items-center justify-between mb-6\">\n          <div className=\"flex items-center gap-2\">\n            <img\n              src=\"https://res.cloudinary.com/dru3aznlk/image/upload/v1760692589/kip-vignette_h2jwct.png\"\n              alt=\"Kip logo\"\n              className=\"w-8 h-8\"\n            />\n            <h2 className=\"text-xl font-bold text-gray-800\">Save Bookmark</h2>\n          </div>\n          <button\n            type=\"button\"\n            onClick={handleClose}\n            className=\"text-gray-400 hover:text-gray-600 text-2xl\"\n            disabled={saving}\n          >\n            \u00D7\n          </button>\n        </div>\n\n        <div className=\"mb-4 text-sm text-gray-600\">\n          Signed in as <span className=\"font-medium\">@{session.handle}</span>\n        </div>\n\n        <form onSubmit={handleSave} className=\"space-y-4\">\n          <div>\n            <label\n              htmlFor=\"url\"\n              className=\"block text-sm font-medium text-gray-700 mb-2\"\n            >\n              URL\n            </label>\n            <input\n              type=\"url\"\n              id=\"url\"\n              value={url}\n              onChange={(e) => setUrl(e.target.value)}\n              placeholder=\"https://example.com\"\n              className=\"w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-coral focus:border-transparent outline-none transition\"\n              disabled={saving}\n              autoFocus\n              required\n            />\n          </div>\n\n          {error && (\n            <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm\">\n              {error}\n            </div>\n          )}\n\n          <button\n            type=\"submit\"\n            className=\"w-full btn-primary py-3 disabled:opacity-50\"\n            disabled={saving || !url.trim()}\n          >\n            {saving\n              ? (\n                <span className=\"flex items-center justify-center gap-2\">\n                  <div className=\"spinner w-5 h-5 border-2\"></div>\n                  Saving...\n                </span>\n              )\n              : (\n                \"Save Bookmark\"\n              )}\n          </button>\n        </form>\n\n        <p className=\"text-xs text-gray-500 mt-4 text-center\">\n          The page title and description will be automatically fetched\n        </p>\n      </div>\n    </div>\n  );\n}\n", "export function FAQ() {\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <header className=\"bg-white shadow-sm\">\n        <div className=\"max-w-4xl mx-auto px-4 py-4 flex items-center justify-between\">\n          <a href=\"/\" className=\"flex items-center gap-2\">\n            <img\n              src=\"https://res.cloudinary.com/dru3aznlk/image/upload/v1760692589/kip-vignette_h2jwct.png\"\n              alt=\"Kip logo\"\n              className=\"w-8 h-8\"\n            />\n            <h1\n              className=\"text-2xl font-bold\"\n              style={{ color: \"var(--coral)\" }}\n            >\n              kipclip\n            </h1>\n          </a>\n          <a\n            href=\"/\"\n            className=\"text-gray-600 hover:text-gray-800 text-sm font-medium\"\n          >\n            Back to Home\n          </a>\n        </div>\n      </header>\n\n      <main className=\"max-w-4xl mx-auto px-4 py-12 space-y-8\">\n        <section>\n          <h2 className=\"text-3xl font-bold text-gray-800 mb-3\">\n            Frequently Asked Questions\n          </h2>\n          <p className=\"text-gray-700 text-lg\">\n            Everything you need to know about using kipclip with Bluesky and AT\n            Protocol.\n          </p>\n        </section>\n\n        <section className=\"bg-white rounded-lg shadow-md p-6 space-y-6\">\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              What is AT Protocol?\n            </h3>\n            <p className=\"text-gray-700\">\n              AT Protocol is an open, decentralized social networking protocol.\n              It's the technology that powers Bluesky and allows your data to be\n              portable across different apps and services. Think of it like\n              email - you own your address and can use it with different email\n              clients.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              Can I use my Bluesky account to sign in?\n            </h3>\n            <p className=\"text-gray-700\">\n              Yes! Your Bluesky account is an AT Protocol account. Just enter\n              your Bluesky handle (like alice.bsky.social) to sign in. kipclip\n              works seamlessly with Bluesky because they both use AT Protocol.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              How does the login process work?\n            </h3>\n            <p className=\"text-gray-700\">\n              When you sign in, kipclip uses OAuth to securely connect to your\n              Personal Data Server (PDS). This is the same secure login method\n              used by apps like Twitter or Google. You'll be redirected to your\n              PDS to authorize kipclip, then redirected back. Your password is\n              never shared with kipclip.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              Where are my bookmarks stored?\n            </h3>\n            <p className=\"text-gray-700\">\n              Your bookmarks are stored in your own Personal Data Server (PDS),\n              not on kipclip's servers. If you use Bluesky, that's your Bluesky\n              PDS. This means you own your data and can access it with other AT\n              Protocol apps that support the bookmark format.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              Can I share my bookmarks?\n            </h3>\n            <p className=\"text-gray-700\">\n              Yes! You can tag your bookmarks with custom labels, and kipclip\n              automatically creates shareable collections based on those tags.\n              Each collection gets its own unique URL with custom preview cards\n              when shared on social media, making it easy to share curated lists\n              with others.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              Can I use a custom domain as my handle?\n            </h3>\n            <p className=\"text-gray-700\">\n              Yes! If you've set up a custom domain handle with AT Protocol\n              (like yourname.com), you can use it to sign in to kipclip. Just\n              enter your custom domain handle instead of a .bsky.social handle.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              Is my data portable?\n            </h3>\n            <p className=\"text-gray-700\">\n              Absolutely! Because your bookmarks are stored using the community\n              bookmark lexicon on your PDS, you can access them with any other\n              AT Protocol app that supports this format. You're not locked into\n              kipclip - your data is truly yours.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              What happens if I move to a different PDS?\n            </h3>\n            <p className=\"text-gray-700\">\n              Your bookmarks move with you! When you migrate your account to a\n              different PDS (using tools like{\" \"}\n              <a\n                href=\"https://pdsmoover.com\"\n                target=\"_blank\"\n                rel=\"noopener\"\n                className=\"underline hover:text-gray-800\"\n              >\n                pdsmoover.com\n              </a>\n              ), all your data including bookmarks transfers automatically.\n              They're tied to your account, not to kipclip or any specific\n              server.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              What happens to my bookmarks if kipclip shuts down?\n            </h3>\n            <p className=\"text-gray-700\">\n              Your bookmarks remain safe on your PDS - they're just JSON files\n              stored with your account data. You could use another app that\n              supports the community bookmark lexicon, or even build your own\n              tool. Since kipclip is open source, you or anyone else could also\n              host a copy of it.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              Are my bookmarks private?\n            </h3>\n            <p className=\"text-gray-700\">\n              No, AT Protocol records are public by default. This means\n              bookmarks you save with kipclip can be discovered by others.\n              Please don't save anything sensitive or private. Think of kipclip\n              bookmarks like public social media posts.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              What is the community bookmark lexicon?\n            </h3>\n            <p className=\"text-gray-700\">\n              A lexicon is like a data schema in AT Protocol. The{\" \"}\n              <a\n                href=\"https://github.com/lexicon-community/lexicon/blob/main/community/lexicon/bookmarks/bookmark.json\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"underline hover:text-gray-800\"\n              >\n                community bookmark lexicon\n              </a>{\" \"}\n              defines the standard format for bookmarks. By using this standard,\n              kipclip ensures your bookmarks can be read by other compatible\n              apps.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              Does kipclip support RSS feeds?\n            </h3>\n            <p className=\"text-gray-700\">\n              Absolutely! Every shared collection has its own RSS feed that you\n              can subscribe to in your favorite RSS reader. Simply add \"/rss\" to\n              the end of any collection URL to access the feed. RSS readers will\n              also auto-discover the feed when you visit a collection page.\n            </p>\n          </div>\n\n          <div>\n            <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n              Is kipclip affiliated with Bluesky?\n            </h3>\n            <p className=\"text-gray-700\">\n              No, kipclip is an independent project built on top of AT Protocol.\n              It's designed to work with any AT Protocol account, including\n              Bluesky accounts, but it's not officially affiliated with Bluesky\n              Social PBC.\n            </p>\n          </div>\n        </section>\n\n        <section className=\"bg-white rounded-lg shadow-md p-6\">\n          <h3 className=\"text-xl font-bold text-gray-800 mb-4\">\n            Still have questions?\n          </h3>\n          <p className=\"text-gray-700 mb-4\">\n            Check out the{\" \"}\n            <a\n              href=\"/about\"\n              className=\"underline hover:text-gray-800\"\n            >\n              About page\n            </a>{\" \"}\n            for more information, or reach out on{\" \"}\n            <a\n              href=\"https://bsky.app/profile/tijs.org\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"underline hover:text-gray-800\"\n            >\n              Bluesky\n            </a>\n            .\n          </p>\n        </section>\n      </main>\n    </div>\n  );\n}\n", "import { useEffect, useState } from \"react\";\nimport type { EnrichedBookmark } from \"../../shared/types.ts\";\n\ninterface SharedBookmarksProps {\n  did: string;\n  encodedTags: string;\n}\n\nexport function SharedBookmarks({ did, encodedTags }: SharedBookmarksProps) {\n  const [bookmarks, setBookmarks] = useState<EnrichedBookmark[]>([]);\n  const [handle, setHandle] = useState<string>(\"\");\n  const [tags, setTags] = useState<string[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    loadSharedBookmarks();\n  }, [did, encodedTags]);\n\n  // Update meta tags for Open Graph sharing\n  useEffect(() => {\n    if (!handle || tags.length === 0) return;\n\n    const title = `${handle}'s Bookmarks Collection: ${tags.join(\", \")}`;\n    const description = bookmarks.length > 0\n      ? `${bookmarks.length} bookmark${\n        bookmarks.length === 1 ? \"\" : \"s\"\n      } tagged with ${tags.join(\", \")}`\n      : `Bookmark collection tagged with ${tags.join(\", \")}`;\n    const url = globalThis.location.href;\n\n    // Update document title\n    document.title = title;\n\n    // Update or create meta tags\n    updateMetaTag(\"og:title\", title);\n    updateMetaTag(\"og:description\", description);\n    updateMetaTag(\"og:url\", url);\n    updateMetaTag(\"og:type\", \"website\");\n    updateMetaTag(\"og:site_name\", \"kipclip\");\n\n    // Twitter Card tags\n    updateMetaTag(\"twitter:card\", \"summary\", \"name\");\n    updateMetaTag(\"twitter:title\", title, \"name\");\n    updateMetaTag(\"twitter:description\", description, \"name\");\n\n    // Cleanup function to restore original title\n    return () => {\n      document.title = \"kipclip\";\n    };\n  }, [handle, tags, bookmarks.length]);\n\n  function updateMetaTag(\n    property: string,\n    content: string,\n    attributeName: \"property\" | \"name\" = \"property\",\n  ) {\n    let meta = document.querySelector(\n      `meta[${attributeName}=\"${property}\"]`,\n    ) as HTMLMetaElement;\n\n    if (!meta) {\n      meta = document.createElement(\"meta\");\n      meta.setAttribute(attributeName, property);\n      document.head.appendChild(meta);\n    }\n\n    meta.content = content;\n  }\n\n  async function loadSharedBookmarks() {\n    setLoading(true);\n    setError(null);\n    try {\n      const response = await fetch(`/api/share/${did}/${encodedTags}`);\n      if (!response.ok) {\n        const data = await response.json();\n        throw new Error(data.error || \"Failed to load shared bookmarks\");\n      }\n      const data = await response.json();\n      setBookmarks(data.bookmarks);\n      setHandle(data.handle);\n      setTags(data.tags);\n    } catch (err: any) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  function handleVisit(e: React.MouseEvent, url: string) {\n    e.stopPropagation();\n    globalThis.open(url, \"_blank\", \"noopener,noreferrer\");\n  }\n\n  async function handleShare(e: React.MouseEvent, bookmark: any) {\n    e.stopPropagation();\n\n    const shareData = {\n      title: bookmark.title || new URL(bookmark.subject).hostname,\n      text: bookmark.description\n        ? `${\n          bookmark.title || new URL(bookmark.subject).hostname\n        }\\n\\n${bookmark.description}`\n        : bookmark.title || new URL(bookmark.subject).hostname,\n      url: bookmark.subject,\n    };\n\n    // Check if Web Share API is supported\n    if (navigator.share) {\n      try {\n        await navigator.share(shareData);\n      } catch (err: any) {\n        // User cancelled or share failed\n        if (err.name !== \"AbortError\") {\n          console.error(\"Share failed:\", err);\n        }\n      }\n    } else {\n      // Fallback: copy to clipboard\n      try {\n        const textToCopy =\n          `${shareData.title}\\n${shareData.text}\\n${shareData.url}`;\n        await navigator.clipboard.writeText(textToCopy);\n        alert(\"Link copied to clipboard!\");\n      } catch (err) {\n        console.error(\"Failed to copy:\", err);\n        alert(\"Sharing not supported on this browser\");\n      }\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"spinner\"></div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-gray-50 flex items-center justify-center\">\n        <div className=\"text-center py-20 px-4\">\n          <div className=\"mb-6\">\n            <span className=\"text-6xl\">\u26A0\uFE0F</span>\n          </div>\n          <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">\n            Error Loading Bookmarks\n          </h3>\n          <p className=\"text-red-600 mb-6\">{error}</p>\n          <button\n            type=\"button\"\n            onClick={loadSharedBookmarks}\n            className=\"btn-primary\"\n          >\n            Try Again\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <div className=\"max-w-7xl mx-auto px-4 py-8\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-2 text-sm text-gray-600 mb-2\">\n            <span>Shared by</span>\n            <a\n              href={`https://bsky.app/profile/${handle}`}\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"font-semibold text-blue-600 hover:text-blue-800 hover:underline\"\n            >\n              {handle}\n            </a>\n          </div>\n          <h1 className=\"text-3xl font-bold text-gray-800 mb-4\">\n            Bookmarks Collection\n          </h1>\n          <div className=\"flex flex-wrap gap-2\">\n            <span className=\"text-sm text-gray-600\">Filtered by tags:</span>\n            {tags.map((tag) => (\n              <span\n                key={tag}\n                className=\"px-3 py-1 text-sm rounded-full bg-blue-100 text-blue-700 font-medium\"\n              >\n                {tag}\n              </span>\n            ))}\n          </div>\n        </div>\n\n        {/* Bookmarks */}\n        {bookmarks.length === 0\n          ? (\n            <div className=\"text-center py-20\">\n              <div className=\"mb-6\">\n                <span className=\"text-6xl\">\uD83D\uDCDA</span>\n              </div>\n              <h3 className=\"text-xl font-semibold text-gray-700 mb-2\">\n                No bookmarks found\n              </h3>\n              <p className=\"text-gray-500\">\n                This user hasn't shared any bookmarks with these tags yet.\n              </p>\n            </div>\n          )\n          : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {bookmarks.map((bookmark) => (\n                <div\n                  key={bookmark.uri}\n                  className=\"card hover:scale-[1.02] transition-all group relative\"\n                >\n                  <div className=\"mb-3\">\n                    <h3 className=\"font-semibold text-gray-800 truncate mb-1\">\n                      {bookmark.title || new URL(bookmark.subject).hostname}\n                    </h3>\n                    <div className=\"text-sm text-gray-500 truncate\">\n                      {bookmark.subject}\n                    </div>\n                  </div>\n\n                  {bookmark.description && (\n                    <p className=\"text-sm text-gray-600 mb-3 line-clamp-2\">\n                      {bookmark.description}\n                    </p>\n                  )}\n\n                  <div className=\"text-xs text-gray-400\">\n                    {new Date(bookmark.createdAt).toLocaleDateString()}\n                  </div>\n\n                  {/* Desktop: hover-reveal buttons (bottom-right) */}\n                  <div className=\"hidden md:group-hover:flex absolute bottom-2 right-2 gap-1\">\n                    <button\n                      type=\"button\"\n                      onClick={(e) => handleVisit(e, bookmark.subject)}\n                      className=\"w-7 h-7 flex items-center justify-center text-gray-600 hover:text-gray-900 bg-white/90 hover:bg-white rounded-md transition-colors shadow-sm\"\n                      title=\"Visit bookmark\"\n                    >\n                      <svg\n                        className=\"w-4 h-4\"\n                        fill=\"none\"\n                        stroke=\"currentColor\"\n                        viewBox=\"0 0 24 24\"\n                      >\n                        <path\n                          strokeLinecap=\"round\"\n                          strokeLinejoin=\"round\"\n                          strokeWidth={2}\n                          d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\"\n                        />\n                      </svg>\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={(e) => handleShare(e, bookmark)}\n                      className=\"w-7 h-7 flex items-center justify-center text-gray-600 hover:text-gray-900 bg-white/90 hover:bg-white rounded-md transition-colors shadow-sm\"\n                      title=\"Share bookmark\"\n                    >\n                      <svg\n                        className=\"w-4 h-4\"\n                        fill=\"none\"\n                        stroke=\"currentColor\"\n                        viewBox=\"0 0 24 24\"\n                      >\n                        <path\n                          strokeLinecap=\"round\"\n                          strokeLinejoin=\"round\"\n                          strokeWidth={2}\n                          d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z\"\n                        />\n                      </svg>\n                    </button>\n                  </div>\n\n                  {/* Mobile: always-visible buttons (bottom-right) */}\n                  <div className=\"flex md:hidden absolute bottom-2 right-2 gap-1\">\n                    <button\n                      type=\"button\"\n                      onClick={(e) => handleVisit(e, bookmark.subject)}\n                      className=\"w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 bg-white/90 hover:bg-white rounded-md transition-colors shadow-sm\"\n                      title=\"Visit bookmark\"\n                    >\n                      <svg\n                        className=\"w-4 h-4\"\n                        fill=\"none\"\n                        stroke=\"currentColor\"\n                        viewBox=\"0 0 24 24\"\n                      >\n                        <path\n                          strokeLinecap=\"round\"\n                          strokeLinejoin=\"round\"\n                          strokeWidth={2}\n                          d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\"\n                        />\n                      </svg>\n                    </button>\n                    <button\n                      type=\"button\"\n                      onClick={(e) => handleShare(e, bookmark)}\n                      className=\"w-8 h-8 flex items-center justify-center text-gray-600 hover:text-gray-900 bg-white/90 hover:bg-white rounded-md transition-colors shadow-sm\"\n                      title=\"Share bookmark\"\n                    >\n                      <svg\n                        className=\"w-4 h-4\"\n                        fill=\"none\"\n                        stroke=\"currentColor\"\n                        viewBox=\"0 0 24 24\"\n                      >\n                        <path\n                          strokeLinecap=\"round\"\n                          strokeLinejoin=\"round\"\n                          strokeWidth={2}\n                          d=\"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z\"\n                        />\n                      </svg>\n                    </button>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n\n        {/* Footer */}\n        <div className=\"mt-12 pt-8 border-t border-gray-200 text-center\">\n          <p className=\"text-sm text-gray-600\">\n            Create your own bookmark collection at{\" \"}\n            <a\n              href=\"/\"\n              className=\"text-blue-600 hover:underline font-medium\"\n            >\n              kipclip.com\n            </a>\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],
  "mappings": "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",
  "names": ["createRoot", "useEffect", "useState", "useEffect", "useRef", "useState", "jsx", "jsxs", "validateHandle", "handle", "trimmed", "Login", "setHandle", "loading", "setLoading", "error", "setError", "inputRef", "input", "handleInput", "handleLogin", "e", "currentHandle", "validation", "redirect", "loginUrl", "useEffect", "useRef", "useState", "useState", "jsx", "jsxs", "AddBookmark", "onClose", "onBookmarkAdded", "url", "setUrl", "loading", "setLoading", "error", "setError", "handleSubmit", "e", "response", "data", "err", "useState", "jsx", "jsxs", "EditBookmark", "bookmark", "availableTags", "onClose", "onBookmarkUpdated", "onBookmarkDeleted", "onTagsChanged", "tags", "setTags", "tagInput", "setTagInput", "showSuggestions", "setShowSuggestions", "loading", "setLoading", "error", "setError", "title", "setTitle", "url", "setUrl", "description", "setDescription", "suggestions", "tag", "handleAddTag", "tagValue", "handleRemoveTag", "t", "handleTagInputKeyDown", "e", "handleSave", "existingTagValues", "newTags", "err", "rkey", "response", "data", "handleDelete", "createContext", "useContext", "useState", "apiFetch", "url", "options", "response", "error", "apiGet", "jsx", "AppContext", "createContext", "AppProvider", "children", "session", "setSession", "useState", "bookmarks", "setBookmarks", "tags", "setTags", "selectedTags", "setSelectedTags", "loading", "_setLoading", "loadBookmarks", "response", "apiGet", "data", "err", "addBookmark", "bookmark", "prev", "updateBookmark", "b", "deleteBookmark", "uri", "loadTags", "addTag", "tag", "updateTag", "t", "deleteTag", "loadInitialData", "toggleTag", "tagValue", "newSet", "clearFilters", "filteredBookmarks", "value", "useApp", "context", "useContext", "jsx", "jsxs", "BookmarkList", "bookmarks", "availableTags", "addBookmark", "updateBookmark", "deleteBookmark", "loadBookmarksFromContext", "loadTags", "useApp", "showAddModal", "setShowAddModal", "useState", "editingBookmark", "setEditingBookmark", "error", "setError", "dragOverBookmark", "setDragOverBookmark", "pullDistance", "setPullDistance", "isPulling", "setIsPulling", "isRefreshing", "setIsRefreshing", "touchStartY", "useRef", "useEffect", "isAtTop", "mainElement", "windowAtTop", "mainAtTop", "handleTouchStart", "e", "handleTouchMove", "distance", "handleTouchEnd", "loadBookmarks", "err", "handleBookmarkUpdated", "bookmark", "handleBookmarkDeleted", "uri", "handleBookmarkAdded", "handleDropTag", "bookmarkUri", "tagValue", "rkey", "b", "newTags", "response", "data", "handleVisit", "url", "handleShare", "shareData", "textToCopy", "tag", "i", "AddBookmark", "EditBookmark", "useEffect", "useRef", "useState", "jsx", "jsxs", "UserMenu", "handle", "onLogout", "isOpen", "setIsOpen", "menuRef", "handleClickOutside", "event", "useState", "useState", "jsx", "jsxs", "AddTag", "onClose", "onTagAdded", "value", "setValue", "loading", "setLoading", "error", "setError", "handleSubmit", "e", "response", "data", "err", "useState", "jsx", "jsxs", "EditTag", "tag", "onClose", "onTagUpdated", "onTagDeleted", "loadBookmarks", "useApp", "value", "setValue", "useState", "isSubmitting", "setIsSubmitting", "isDeleting", "setIsDeleting", "error", "setError", "rkey", "handleSubmit", "newValue", "hasChanged", "response", "data", "err", "handleDelete", "usageResponse", "count", "confirmMessage", "deleteResponse", "encodeTagsForUrl", "tags", "joined", "Fragment", "jsx", "jsxs", "TagSidebar", "tags", "selectedTags", "toggleTag", "clearFilters", "loadTagsFromContext", "addTag", "updateTag", "deleteTag", "session", "useApp", "showAddModal", "setShowAddModal", "useState", "editingTag", "setEditingTag", "error", "setError", "refreshing", "setRefreshing", "loadTags", "err", "handleTagAdded", "tag", "handleTagUpdated", "updatedTag", "handleTagDeleted", "tagUri", "handleShareFiltered", "encodedTags", "encodeTagsForUrl", "shareUrl", "renderTag", "isSelected", "e", "listItem", "AddTag", "EditTag", "useEffect", "useRef", "useState", "jsx", "jsxs", "Tools", "copied", "setCopied", "bookmarkletContainerRef", "bookmarkletCode", "anchor", "handleCopy", "err", "e", "jsx", "jsxs", "About", "useEffect", "useState", "jsx", "jsxs", "Save", "session", "setSession", "loading", "setLoading", "saving", "setSaving", "saved", "setSaved", "error", "setError", "url", "setUrl", "urlParam", "checkSession", "response", "data", "errorData", "handleSave", "e", "loginUrl", "err", "handleClose", "jsx", "jsxs", "FAQ", "useEffect", "useState", "jsx", "jsxs", "SharedBookmarks", "did", "encodedTags", "bookmarks", "setBookmarks", "handle", "setHandle", "tags", "setTags", "loading", "setLoading", "error", "setError", "loadSharedBookmarks", "title", "description", "url", "updateMetaTag", "property", "content", "attributeName", "meta", "response", "data", "err", "handleVisit", "handleShare", "bookmark", "shareData", "textToCopy", "tag", "e", "jsx", "jsxs", "App", "session", "setSession", "loadInitialData", "useApp", "loading", "setLoading", "useState", "dataLoading", "setDataLoading", "currentPath", "setCurrentPath", "useEffect", "checkSession", "handlePopState", "error", "response", "data", "handleLogout", "Tools", "About", "FAQ", "Save", "pathParts", "did", "encodedTags", "SharedBookmarks", "UserMenu", "TagSidebar", "BookmarkList", "Login", "jsx", "createRoot", "AppProvider", "App"]
}
